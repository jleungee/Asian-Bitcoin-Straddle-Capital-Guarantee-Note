<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="data:text/css,%0A%40font%2Dface%20%7B%0Afont%2Dfamily%3A%20octicons%2Dlink%3B%0Asrc%3A%20url%28data%3Afont%2Fwoff%3Bcharset%3Dutf%2D8%3Bbase64%2Cd09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM%2B8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB%2FaFGpk3jaTY6xa8JAGMW%2FO62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v%2Bk%2F0an2i%2BitHDw3v2%2B9%2BDBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3%2FI7AtxEJLtzzuZfI%2BVVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy%2FLt7Kc%2B0vWY%2FgAgIIEqAN9we0pwKXreiMasxvabDQMM4riO%2BqxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw%2Bymhce7vwM9jSqO8JyVd5RH9gyTt2%2BJ%2FyUmYlIR0s04n6%2B7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv%2FocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi%2BW2%2BMjCzMIDApSwvXzC97Z4Ig8N%2FBxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh%2F8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT%2BAEjAwuDFpBmA9KMDEwMCh9i%2Fv8H8sH0%2F4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9%2FlqYwOGZxeUelN2U2R6%2BcArgtCJpauW7UQBqnFkUsjAY%2FkOU1cP%2BDAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl%2BvvmM%2FbyA48e6tWrKArm4ZJlCbdsrxksL1AwWn%2FyBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO%2F%2FsdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd%2F89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF%2B9JOS0nbaaYDCQfwCJ7Au3AHj%2BLO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm%2BEBXuAbHmIMSRMs%2B4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL%2BhD7C1xoaHeLJSEao0FEW14ckxC%2BTU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13%2F%2Blm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl%2B9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O%2FAdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB%2F%2F%2FAA8AAQAAAAAAAAAAAAAAAAABAAAAAA%3D%3D%29%20format%28%27woff%27%29%3B%0A%7D%0Abody%20%7B%0A%2Dwebkit%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0Atext%2Dsize%2Dadjust%3A%20100%25%3B%0Acolor%3A%20%23333%3B%0Afont%2Dfamily%3A%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20%22Segoe%20UI%22%2C%20Arial%2C%20freesans%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0Afont%2Dsize%3A%2016px%3B%0Aline%2Dheight%3A%201%2E6%3B%0Aword%2Dwrap%3A%20break%2Dword%3B%0A%7D%0Aa%20%7B%0Abackground%2Dcolor%3A%20transparent%3B%0A%7D%0Aa%3Aactive%2C%0Aa%3Ahover%20%7B%0Aoutline%3A%200%3B%0A%7D%0Astrong%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%202em%3B%0Amargin%3A%200%2E67em%200%3B%0A%7D%0Aimg%20%7B%0Aborder%3A%200%3B%0A%7D%0Ahr%20%7B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Aheight%3A%200%3B%0A%7D%0Apre%20%7B%0Aoverflow%3A%20auto%3B%0A%7D%0Acode%2C%0Akbd%2C%0Apre%20%7B%0Afont%2Dfamily%3A%20monospace%2C%20monospace%3B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ainput%20%7B%0Acolor%3A%20inherit%3B%0Afont%3A%20inherit%3B%0Amargin%3A%200%3B%0A%7D%0Ahtml%20input%5Bdisabled%5D%20%7B%0Acursor%3A%20default%3B%0A%7D%0Ainput%20%7B%0Aline%2Dheight%3A%20normal%3B%0A%7D%0Ainput%5Btype%3D%22checkbox%22%5D%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Apadding%3A%200%3B%0A%7D%0Atable%20%7B%0Aborder%2Dcollapse%3A%20collapse%3B%0Aborder%2Dspacing%3A%200%3B%0A%7D%0Atd%2C%0Ath%20%7B%0Apadding%3A%200%3B%0A%7D%0A%2A%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0A%7D%0Ainput%20%7B%0Afont%3A%2013px%20%2F%201%2E4%20Helvetica%2C%20arial%2C%20nimbussansl%2C%20liberationsans%2C%20freesans%2C%20clean%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%234078c0%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%2C%0Aa%3Aactive%20%7B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%200%3B%0Amargin%3A%2015px%200%3B%0Aoverflow%3A%20hidden%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0A%7D%0Ahr%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ahr%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%2015px%3B%0Amargin%2Dbottom%3A%2015px%3B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%2030px%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%2021px%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%2016px%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%2011px%3B%0A%7D%0Ablockquote%20%7B%0Amargin%3A%200%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Aol%20ol%2C%0Aul%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Droman%3B%0A%7D%0Aul%20ul%20ol%2C%0Aul%20ol%20ol%2C%0Aol%20ul%20ol%2C%0Aol%20ol%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Dalpha%3B%0A%7D%0Add%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0Afont%3A%2012px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0A%7D%0A%2Eselect%3A%3A%2Dms%2Dexpand%20%7B%0Aopacity%3A%200%3B%0A%7D%0A%2Eocticon%20%7B%0Afont%3A%20normal%20normal%20normal%2016px%2F1%20octicons%2Dlink%3B%0Adisplay%3A%20inline%2Dblock%3B%0Atext%2Ddecoration%3A%20none%3B%0Atext%2Drendering%3A%20auto%3B%0A%2Dwebkit%2Dfont%2Dsmoothing%3A%20antialiased%3B%0A%2Dmoz%2Dosx%2Dfont%2Dsmoothing%3A%20grayscale%3B%0A%2Dwebkit%2Duser%2Dselect%3A%20none%3B%0A%2Dmoz%2Duser%2Dselect%3A%20none%3B%0A%2Dms%2Duser%2Dselect%3A%20none%3B%0Auser%2Dselect%3A%20none%3B%0A%7D%0A%2Eocticon%2Dlink%3Abefore%20%7B%0Acontent%3A%20%27%5Cf05c%27%3B%0A%7D%0A%2Emarkdown%2Dbody%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%20%21important%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%20%21important%3B%0A%7D%0Aa%3Anot%28%5Bhref%5D%29%20%7B%0Acolor%3A%20inherit%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0A%2Eanchor%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%2Dright%3A%202px%3B%0Amargin%2Dleft%3A%20%2D18px%3B%0A%7D%0A%2Eanchor%3Afocus%20%7B%0Aoutline%3A%20none%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%201em%3B%0Amargin%2Dbottom%3A%2016px%3B%0Afont%2Dweight%3A%20bold%3B%0Aline%2Dheight%3A%201%2E4%3B%0A%7D%0Ah1%20%2Eocticon%2Dlink%2C%0Ah2%20%2Eocticon%2Dlink%2C%0Ah3%20%2Eocticon%2Dlink%2C%0Ah4%20%2Eocticon%2Dlink%2C%0Ah5%20%2Eocticon%2Dlink%2C%0Ah6%20%2Eocticon%2Dlink%20%7B%0Acolor%3A%20%23000%3B%0Avertical%2Dalign%3A%20middle%3B%0Avisibility%3A%20hidden%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%2C%0Ah2%3Ahover%20%2Eanchor%2C%0Ah3%3Ahover%20%2Eanchor%2C%0Ah4%3Ahover%20%2Eanchor%2C%0Ah5%3Ahover%20%2Eanchor%2C%0Ah6%3Ahover%20%2Eanchor%20%7B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah2%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah3%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah4%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah5%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah6%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%20%7B%0Avisibility%3A%20visible%3B%0A%7D%0Ah1%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%202%2E25em%3B%0Aline%2Dheight%3A%201%2E2%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah1%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah2%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%201%2E75em%3B%0Aline%2Dheight%3A%201%2E225%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah2%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%201%2E5em%3B%0Aline%2Dheight%3A%201%2E43%3B%0A%7D%0Ah3%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%201%2E25em%3B%0A%7D%0Ah4%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ah5%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%201em%3B%0Acolor%3A%20%23777%3B%0A%7D%0Ah6%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ap%2C%0Ablockquote%2C%0Aul%2C%0Aol%2C%0Adl%2C%0Atable%2C%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%204px%3B%0Apadding%3A%200%3B%0Amargin%3A%2016px%200%3B%0Abackground%2Dcolor%3A%20%23e7e7e7%3B%0Aborder%3A%200%20none%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%2Dleft%3A%202em%3B%0A%7D%0Aul%20ul%2C%0Aul%20ol%2C%0Aol%20ol%2C%0Aol%20ul%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Ali%3Ep%20%7B%0Amargin%2Dtop%3A%2016px%3B%0A%7D%0Adl%20%7B%0Apadding%3A%200%3B%0A%7D%0Adl%20dt%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%2016px%3B%0Afont%2Dsize%3A%201em%3B%0Afont%2Dstyle%3A%20italic%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Adl%20dd%20%7B%0Apadding%3A%200%2016px%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ablockquote%20%7B%0Apadding%3A%200%2015px%3B%0Acolor%3A%20%23777%3B%0Aborder%2Dleft%3A%204px%20solid%20%23ddd%3B%0A%7D%0Ablockquote%3E%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Ablockquote%3E%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Atable%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Aoverflow%3A%20auto%3B%0Aword%2Dbreak%3A%20normal%3B%0Aword%2Dbreak%3A%20keep%2Dall%3B%0A%7D%0Atable%20th%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Atable%20th%2C%0Atable%20td%20%7B%0Apadding%3A%206px%2013px%3B%0Aborder%3A%201px%20solid%20%23ddd%3B%0A%7D%0Atable%20tr%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Aborder%2Dtop%3A%201px%20solid%20%23ccc%3B%0A%7D%0Atable%20tr%3Anth%2Dchild%282n%29%20%7B%0Abackground%2Dcolor%3A%20%23f8f8f8%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%3B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Abackground%2Dcolor%3A%20%23fff%3B%0A%7D%0Acode%20%7B%0Apadding%3A%200%3B%0Apadding%2Dtop%3A%200%2E2em%3B%0Apadding%2Dbottom%3A%200%2E2em%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%2085%25%3B%0Abackground%2Dcolor%3A%20rgba%280%2C0%2C0%2C0%2E04%29%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0Acode%3Abefore%2C%0Acode%3Aafter%20%7B%0Aletter%2Dspacing%3A%20%2D0%2E2em%3B%0Acontent%3A%20%22%5C00a0%22%3B%0A%7D%0Apre%3Ecode%20%7B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%20100%25%3B%0Aword%2Dbreak%3A%20normal%3B%0Awhite%2Dspace%3A%20pre%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0A%2Ehighlight%20%7B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0A%2Ehighlight%20pre%2C%0Apre%20%7B%0Apadding%3A%2016px%3B%0Aoverflow%3A%20auto%3B%0Afont%2Dsize%3A%2085%25%3B%0Aline%2Dheight%3A%201%2E45%3B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0A%2Ehighlight%20pre%20%7B%0Amargin%2Dbottom%3A%200%3B%0Aword%2Dbreak%3A%20normal%3B%0A%7D%0Apre%20%7B%0Aword%2Dwrap%3A%20normal%3B%0A%7D%0Apre%20code%20%7B%0Adisplay%3A%20inline%3B%0Amax%2Dwidth%3A%20initial%3B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Aoverflow%3A%20initial%3B%0Aline%2Dheight%3A%20inherit%3B%0Aword%2Dwrap%3A%20normal%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0Apre%20code%3Abefore%2C%0Apre%20code%3Aafter%20%7B%0Acontent%3A%20normal%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%2Dsize%3A%2011px%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Epl%2Dc%20%7B%0Acolor%3A%20%23969896%3B%0A%7D%0A%2Epl%2Dc1%2C%0A%2Epl%2Ds%20%2Epl%2Dv%20%7B%0Acolor%3A%20%230086b3%3B%0A%7D%0A%2Epl%2De%2C%0A%2Epl%2Den%20%7B%0Acolor%3A%20%23795da3%3B%0A%7D%0A%2Epl%2Ds%20%2Epl%2Ds1%2C%0A%2Epl%2Dsmi%20%7B%0Acolor%3A%20%23333%3B%0A%7D%0A%2Epl%2Dent%20%7B%0Acolor%3A%20%2363a35c%3B%0A%7D%0A%2Epl%2Dk%20%7B%0Acolor%3A%20%23a71d5d%3B%0A%7D%0A%2Epl%2Dpds%2C%0A%2Epl%2Ds%2C%0A%2Epl%2Ds%20%2Epl%2Dpse%20%2Epl%2Ds1%2C%0A%2Epl%2Dsr%2C%0A%2Epl%2Dsr%20%2Epl%2Dcce%2C%0A%2Epl%2Dsr%20%2Epl%2Dsra%2C%0A%2Epl%2Dsr%20%2Epl%2Dsre%20%7B%0Acolor%3A%20%23183691%3B%0A%7D%0A%2Epl%2Dv%20%7B%0Acolor%3A%20%23ed6a43%3B%0A%7D%0A%2Epl%2Did%20%7B%0Acolor%3A%20%23b52a1d%3B%0A%7D%0A%2Epl%2Dii%20%7B%0Abackground%2Dcolor%3A%20%23b52a1d%3B%0Acolor%3A%20%23f8f8f8%3B%0A%7D%0A%2Epl%2Dsr%20%2Epl%2Dcce%20%7B%0Acolor%3A%20%2363a35c%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dml%20%7B%0Acolor%3A%20%23693a17%3B%0A%7D%0A%2Epl%2Dmh%2C%0A%2Epl%2Dmh%20%2Epl%2Den%2C%0A%2Epl%2Dms%20%7B%0Acolor%3A%20%231d3e81%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmq%20%7B%0Acolor%3A%20%23008080%3B%0A%7D%0A%2Epl%2Dmi%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dstyle%3A%20italic%3B%0A%7D%0A%2Epl%2Dmb%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmd%20%7B%0Abackground%2Dcolor%3A%20%23ffecec%3B%0Acolor%3A%20%23bd2c00%3B%0A%7D%0A%2Epl%2Dmi1%20%7B%0Abackground%2Dcolor%3A%20%23eaffea%3B%0Acolor%3A%20%2355a532%3B%0A%7D%0A%2Epl%2Dmdr%20%7B%0Acolor%3A%20%23795da3%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmo%20%7B%0Acolor%3A%20%231d3e81%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%3A%2011px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20%7B%0Alist%2Dstyle%2Dtype%3A%20none%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%2B%2Etask%2Dlist%2Ditem%20%7B%0Amargin%2Dtop%3A%203px%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20input%20%7B%0Amargin%3A%200%200%2E35em%200%2E25em%20%2D1%2E6em%3B%0Avertical%2Dalign%3A%20middle%3B%0A%7D%0A%3Achecked%2B%2Eradio%2Dlabel%20%7B%0Az%2Dindex%3A%201%3B%0Aposition%3A%20relative%3B%0Aborder%2Dcolor%3A%20%234078c0%3B%0A%7D%0A%2EsourceLine%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0A%7D%0Acode%20%2Ekw%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Edt%20%7B%20color%3A%20%23ed6a43%3B%20%7D%0Acode%20%2Edv%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Ebn%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Efl%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Ech%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Est%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Eco%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%2Eot%20%7B%20color%3A%20%230086b3%3B%20%7D%0Acode%20%2Eal%20%7B%20color%3A%20%23a61717%3B%20%7D%0Acode%20%2Efu%20%7B%20color%3A%20%2363a35c%3B%20%7D%0Acode%20%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%0Acode%20%2Ewa%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Ecn%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Esc%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Evs%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Ess%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Eim%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eva%20%7Bcolor%3A%20%23008080%3B%20%7D%0Acode%20%2Ecf%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eop%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Ebu%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eex%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Epp%20%7B%20color%3A%20%23999999%3B%20%7D%0Acode%20%2Eat%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Edo%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%2Ean%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Ecv%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Ein%20%7B%20color%3A%20%23008080%3B%20%7D%0A">
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="fina-4354-final-projectsource-codes">FINA-4354-final-project—source-codes</h1>
<p>Group 4 12/7/2021</p>
<p>Bitcoin is one of the best incarnations of a “High Risk High Return” asset. We understand that many retail investors would like to profit from its high return yet are deterred by its tedious volatility. Hence, we have designed a product, the Asian Bitcoin Straddle Capital Guaranteed Note (ABC Note), which</p>
<ol style="list-style-type: decimal">
<li><p>guarantees your initial capital;</p></li>
<li><p>mitigates the risk greatly;</p></li>
<li><p>has low entry barrier; and</p></li>
<li><p>one can profit no matter price surges or plummets.</p></li>
</ol>
<p>…………………………………………………………………….. ……………………………………………………………………..</p>
<p><strong>Annualized return of 15% in the investment period between 2019-2021</strong></p>
<p>…………………………………………………………………….. ……………………………………………………………………..</p>
<p>To briefly describe the ABC notes, it is compromised with <strong>24 long straddles</strong> which will be executed <strong>monthly</strong>. For each straddle, its <strong>strike price will be set as the mean Bitcoin price in the previous month</strong> and all the monthly payoffs will be <strong>accumulated</strong> and given to the investors after 24 months.</p>
<p>…………………………………………………………………….. ……………………………………………………………………..</p>
<p>This codebook have five sections:</p>
<ol style="list-style-type: decimal">
<li><p>Set-up - Import necessary libraries and data</p></li>
<li><p>Background research of Bitcoin - demonstrate Bitcoin’s characteristics quantitatively and graphically to support the stochastic model used in later sections.</p></li>
<li><p>Monte Carlo Simulation pricing - optimize parameters in the simulation and use simulation to price ABC Note</p></li>
<li><p>Backtesting of the ABC note - Backtest the return of the ABC note from 2017-2021</p></li>
<li><p>Product variant - Explore the alternative structures of ABC Note and show their backtesting results</p></li>
</ol>
<p>**Please do not alter the file locations/working directories of the data and the codebook</p>
<p>**Please note that the five sections above are inter-related and should be run one by one</p>
<p>**The “current” date in this file is “2021-11-17” as it is when Bitcoin option prices are retrieved from outer sources</p>
<p>** It is not a must to run “Data from outer sources (csv and quantmod)” as it is used to display how we get our raw data from csv/quantmod. You can directly run “Data from outer sources (rds)”</p>
<h1 id="1-set-up">1. Set-up</h1>
<h2 id="packages">Packages</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rm(list=ls()) # for debugging</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Installing packages (only run if needed)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&#39;quantmod&#39;)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;tidyverse&quot;)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># So apparently reshape2 can only be run with an updated Rcpp</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;reshape2&quot;) </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;Rcpp&quot;)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># update.packages(&quot;Rcpp&quot;)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;doRNG&quot;)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;doParallel&quot;)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries and libraries</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr) <span class="co"># the %&gt;% library</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># R packages designed for data science</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod) <span class="co"># the Quantitative Financial Modelling Framework</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2) <span class="co"># For melting dataframes</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp) <span class="co"># For melting dataframes</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel) <span class="co"># For running parallel for loop </span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doRNG) <span class="co"># For running parallel for loop with random numbers</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(<span class="at">cores=</span><span class="dv">2</span>) <span class="co"># standard</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># For calculating how long this program needs</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>start.time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the working directory for retrieving data</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">&lt;-</span> <span class="fu">getwd</span>()</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">substr</span>(wd,<span class="dv">1</span>,(<span class="fu">nchar</span>(wd)<span class="sc">-</span><span class="dv">4</span>)),<span class="st">&quot;data&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<h2 id="data-from-outer-sources-csv-and-quantmod">Data from outer sources (csv and quantmod)</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## The codes here are just a display of how the rds files are created</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Not a must to run it</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd(wd) # set working directory</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Getting 3-month Treasury-bill data from FRED</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># dtb3 &lt;- read.csv(&quot;DTB3.csv&quot;) %&gt;% data.frame %&gt;% na.omit</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># dtb3$DTB3 &lt;- dtb3$DTB3 %&gt;% as.numeric # reformatting the price data as numbers</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># dtb3$Date &lt;- dtb3$Date %&gt;% as.Date # reformatting dates to date data type </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="do">## changing annualized price data to daily data</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># dtb3 &lt;- dtb3 %&gt;% mutate(DTB3 = DTB3 / 36000) </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Getting Bitcoin option price from Deribit</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Db.option &lt;- read.csv(&quot;Bitcoin Option.csv&quot;) %&gt;% data.frame %&gt;% na.omit</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="do">## reformatting the date as date type format</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Db.option$Expiry.Date &lt;- Db.option$Expiry.Date %&gt;% as.Date </span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Getting bitcoin prices from quantmod</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="do">## you can add more crypto to the list</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># tick &lt;- tick.c &lt;- c(&quot;BTC&quot;) # tickers that we want to get their price </span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># year &lt;- 10 # number of years of Bitcoin price data to be retrieved</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># date &lt;- as.Date(&quot;2021-11-17&quot;) # deemed as the &quot;current date&quot; </span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># start.date &lt;- date - 365*year # Bitcoin prices are retrieved from this date</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in tick){</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     tryCatch({</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co">#         # Getting price data</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co">#         tick.usd &lt;- paste(i,&quot;-USD&quot;,sep=&quot;&quot;) # add &quot;-USD&quot; at the back of ticker</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co">#         getSymbols(tick.usd, from = start.date) # get price data</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co">#         # only get the adjusted price</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co">#         ad.price &lt;- tick.usd %&gt;% get %&gt;% Ad %&gt;% data.frame %&gt;% na.omit </span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co">#         # Add a column of date which was originally the rownames</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co">#         Date &lt;- rownames(ad.price) %&gt;% as.Date </span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co">#         # assign the price variable name as the ticker without the &quot;-USD&quot; </span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co">#         assign(i,cbind(Date,ad.price)) </span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co">#         # Calculating Return</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co">#         tick.r &lt;- paste(i,&quot;.r&quot;,sep=&quot;&quot;) # creating the variable name</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co">#         r &lt;- ad.price[,1] %&gt;% log %&gt;% diff %&gt;% data.frame %&gt;% na.omit # return </span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="co">#         # Add a column of date</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co">#         r_df &lt;- cbind(Date[2:length(Date)],r) %&gt;% na.omit %&gt;% data.frame </span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co">#         assign(tick.r,r_df) # Assign the return dataframe with a name</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     }, error=function(e){</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co">#         # if there are problems accessing the data</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="co">#         tick.c &lt;- tick.c[tick.c != i]</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co">#         cat(&quot;Not Exist:&quot;,conditionMessage(e), &quot;\n&quot;)}) # print error message</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="do">## Saving data retrieved from csv files/ quantmod as rds</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(dtb3,fil=&quot;dtb3.rds&quot;)</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(Db.option,fil=&quot;Db.option.rds&quot;)</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(BTC,fil=&quot;BTC.rds&quot;)</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(BTC.r,fil=&quot;BTC.r.rds&quot;)</span></span></code></pre></div>
<h2 id="data-from-outer-sources-rds">Data from outer sources (rds)</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(wd)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting data from rds files</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>dtb3 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;dtb3.rds&quot;</span>) <span class="co"># Risk Free Rate</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Db.option <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;Db.option.rds&quot;</span>) <span class="co"># Bitcoin Option</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>BTC <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;BTC.rds&quot;</span>) <span class="co"># Bitcoin price</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>BTC.r <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;BTC.r.rds&quot;</span>) <span class="co"># Bitcoin Return</span></span></code></pre></div>
<h1 id="2-bitcoin-background-research">2. Bitcoin background research</h1>
<p>Bitcoin is a high risk high return cryptocurrency. As you can see in this section, it can yield <strong>&gt;1000% annual simple holding return</strong> yet it has an astonishing <strong>standard error of 197%</strong>. This marks part of our economic motivations to create the ABC Notes - <strong>capturing the high yield of the asset while mitigating its risk</strong>.</p>
<p>With this aim in mind, we tried to investigate its volatility and distribution. We found that its volatility mean-reverting property, as well as heavy tail property. These observations provide support for us to use the Heston Model for simulating Bitcoin price in subsequent sections.</p>
<h2 id="get-bitcoin-prices">Get Bitcoin Prices</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This section of codes help retrieve the price data (USD) of a list of cryptos </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># You can add cryptos other than BTC in the tick vector to retrieve more cryptos</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>tick <span class="ot">&lt;-</span> tick.c <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;BTC&quot;</span>) <span class="co"># A vector of tickers that we want to get their price </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># number of years of Bitcoin price data to be retrieved</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2021-11-17&quot;</span>) <span class="co"># deemed as the &quot;current date&quot; </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>start.date <span class="ot">&lt;-</span> date <span class="sc">-</span> <span class="dv">365</span><span class="sc">*</span>year <span class="co"># Bitcoin prices are retrieved from this date</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tick){</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Getting price data</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        tick.usd <span class="ot">&lt;-</span> <span class="fu">paste</span>(i,<span class="st">&quot;-USD&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>) <span class="co"># add &quot;-USD&quot; at the back of ticker</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">getSymbols</span>(tick.usd, <span class="at">from =</span> start.date) <span class="co"># get price data</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># only get the adjusted price</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        ad.price <span class="ot">&lt;-</span> tick.usd <span class="sc">%&gt;%</span> get <span class="sc">%&gt;%</span> Ad <span class="sc">%&gt;%</span> data.frame <span class="sc">%&gt;%</span> na.omit </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add a column of date which was originally the row names</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        Date <span class="ot">&lt;-</span> <span class="fu">rownames</span>(ad.price) <span class="sc">%&gt;%</span> as.Date </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># assign the price variable name as the ticker without the &quot;-USD&quot; </span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">assign</span>(i,<span class="fu">cbind</span>(Date,ad.price)) </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculating Return</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        tick.r <span class="ot">&lt;-</span> <span class="fu">paste</span>(i,<span class="st">&quot;.r&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>) <span class="co"># creating the variable name</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        r <span class="ot">&lt;-</span> ad.price[,<span class="dv">1</span>] <span class="sc">%&gt;%</span> log <span class="sc">%&gt;%</span> diff <span class="sc">%&gt;%</span> data.frame <span class="sc">%&gt;%</span> na.omit <span class="co"># return </span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add a column of date</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        r_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Date[<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(Date)],r) <span class="sc">%&gt;%</span> na.omit <span class="sc">%&gt;%</span> data.frame </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">assign</span>(tick.r,r_df) <span class="co"># Assign the return data frame with a variable name</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error=</span><span class="cf">function</span>(e){</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if there are problems accessing the data</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>        tick.c <span class="ot">&lt;-</span> tick.c[tick.c <span class="sc">!=</span> i]</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Not Exist:&quot;</span>,<span class="fu">conditionMessage</span>(e), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)}) <span class="co"># print out error message</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 id="brief-review-of-bitcoin">Brief Review of Bitcoin</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here provides a brief view of the price, return, and volatility of bitcoin</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>BTC.ad <span class="ot">&lt;-</span> BTC<span class="sc">$</span>BTC.USD.Adjusted</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>BTC.sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(BTC.r<span class="sc">$</span>.)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">252</span><span class="sc">*</span>year)) <span class="co"># annualized sd of bitcoin</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Max Price:&quot;</span>,<span class="fu">max</span>(BTC.ad),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;Max Daily Return:&quot;</span>,<span class="fu">max</span>(BTC.r<span class="sc">$</span>.),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Max Price: 67566.83   Max Daily Return: 0.225119</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Min Price:&quot;</span>,<span class="fu">min</span>(BTC.ad),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;Min Daily Return:&quot;</span>,<span class="fu">min</span>(BTC.r<span class="sc">$</span>.),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Min Price: 178.103    Min Daily Return: -0.4647302</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean Price:&quot;</span>,<span class="fu">mean</span>(BTC.ad),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;Mean Daily Return:&quot;</span>,<span class="fu">mean</span>(BTC.r<span class="sc">$</span>.),<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Mean Price: 10980.3   Mean Daily Return: 0.00168329</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Simple Holding Payoff:&quot;</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(BTC.ad[<span class="fu">length</span>(BTC.ad)])<span class="sc">-</span><span class="fu">as.numeric</span>(BTC.ad[<span class="dv">1</span>]),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Simple Holding Payoff: 41174.94</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Simple Holding Return: &quot;</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">as.numeric</span>(BTC.ad[<span class="fu">length</span>(BTC.ad)])<span class="sc">/</span><span class="fu">as.numeric</span>(BTC.ad[<span class="dv">1</span>])<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>,<span class="st">&quot;%&quot;</span>,<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## Simple Holding Return: 9003.253%</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Standard Error of Price:&quot;</span>,<span class="fu">sd</span>(BTC.ad)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">252</span><span class="sc">*</span>year)),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Standard Error of Price: 797733.3</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Standard Error of Return:&quot;</span>,<span class="fu">sd</span>(BTC.r<span class="sc">$</span>.)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">252</span><span class="sc">*</span>year)),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Standard Error of Return: 1.967353</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Super high return and fluctuations</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the price (adjusted), return, and 30-day volatility movement</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>vol_30d <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># initializing the vector for 30d volatility</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the 30d vol</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(BTC.r<span class="sc">$</span>.)<span class="sc">-</span><span class="dv">30</span>))){</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    vol_30d[i] <span class="ot">&lt;-</span> (<span class="fu">sd</span>(BTC.r<span class="sc">$</span>.[i<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">30</span>)])<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">252</span>))<span class="sc">^</span><span class="dv">2</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging ad.price, daily return, and 30d vol data</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>BTC.plot <span class="ot">&lt;-</span> <span class="fu">cbind</span>(BTC[<span class="dv">31</span><span class="sc">:</span><span class="fu">length</span>(BTC.r<span class="sc">$</span>.),],</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                  BTC.r<span class="sc">$</span>.[<span class="dv">31</span><span class="sc">:</span><span class="fu">length</span>(BTC.r<span class="sc">$</span>.)],vol_30d) <span class="sc">%&gt;%</span> na.omit </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(BTC.plot) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;Ad&quot;</span>,<span class="st">&quot;r&quot;</span>,<span class="st">&quot;vol&quot;</span>) <span class="co"># changing the column names</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing the dataframe formatting such that it is plottable</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>BTC.plot<span class="sc">$</span>Ad <span class="ot">&lt;-</span> BTC.plot<span class="sc">$</span>Ad<span class="sc">/</span><span class="dv">10000</span> <span class="sc">%&gt;%</span> unlist</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>BTC.plot.s <span class="ot">&lt;-</span> <span class="fu">subset</span>(BTC.plot, Date <span class="sc">&gt;</span> date<span class="dv">-365</span>) <span class="co"># only plot 1 year data</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">melt</span>(BTC.plot.s,<span class="at">id=</span><span class="fu">c</span>(<span class="st">&quot;Date&quot;</span>))</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting the data</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>k,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>Date, <span class="at">y=</span>value, <span class="at">group=</span>variable,<span class="at">colour=</span>variable)) <span class="sc">+</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can see that when Bitcoin price increases, volatility decreases, vice versa</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing only the movement of return and 30d volatility</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>BTC.plot2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(BTC.plot.s, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Ad))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">melt</span>(BTC.plot2,<span class="at">id=</span><span class="fu">c</span>(<span class="st">&quot;Date&quot;</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting the data</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>k,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>Date, <span class="at">y=</span>value, <span class="at">group=</span>variable,<span class="at">colour=</span>variable)) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It seems that return and volatility does not have apparent relationship</span></span></code></pre></div>
<h2 id="mean-reversion-in-bitcoin-volatility">Mean Reversion in Bitcoin volatility</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting only volatility</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>BTC.plot3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(BTC.plot, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(r,Ad),Date <span class="sc">&gt;</span> date<span class="dv">-365</span><span class="sc">*</span><span class="dv">3</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">melt</span>(BTC.plot3,<span class="at">id=</span><span class="fu">c</span>(<span class="st">&quot;Date&quot;</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting the data</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>k,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>Date, <span class="at">y=</span>value, <span class="at">group=</span>variable,<span class="at">colour=</span>variable)) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">col=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Despite great fluctuation in volatility, it reverts around a mean value</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># which shows property of mean reversion</span></span></code></pre></div>
<h2 id="heavy-tails-in-bitcoin-return">Heavy tails in Bitcoin return</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QQplot of bitcoin market return, which shows significant heavy tails </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(BTC.r<span class="sc">$</span>.)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(BTC.r<span class="sc">$</span>., <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAyVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmZgBmZjpmkGZmkJBmkLZmkNtmtrZmtttmtv+QOgCQZjqQkGaQkLaQtpCQttuQ27aQ2/+2ZgC2Zjq2ZpC2kGa225C227a22/+2/7a2///bkDrbkGbbtmbbtpDb25Db27bb29vb2//b/7bb/9vb///fU2v/tmb/25D/27b//7b//9v///97ExOoAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAVE0lEQVR4nO2dC2PrtnWA4dtos5uuDyvZq2usdW3NbF12tabZOleOxf//o0YAJCVKIkWCB8Qh+X2J73VoCKDJLwcPgoDJARRjUp8AQBcICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBW8mMeSn++tiax8GfPe7M5q3+j+//3hjzd9+8NVJcHdwbz8+/u/h8+YF//zz4NBYAgrZSCGolGS3ox9eleV98d0pw42AlqHl4vSHoj19/QlA4pxDUhtCxghbfVpwUu3WwFrT46LWgmUFQaJB5eypBbZX8k19ba/bm4Xdfm0//Wfzg+5+Zh2/y/34yX7y6NDYu/vy1IWjh3YOtyL9/Mua5yvvWwb1X8MdtEUKrz9eFZk3B1wOCtuKceK4E3VfBrfp285dtGfB+VslzuFFFF989OHltRmdR9fpgKaj1vxL0VCiCwiVFpfoPhRNe0Pcnq8nexbviz813+f8UPyj+60+FON/4HxRW/e2bTfl8JuhZCyGrrLx9sBT0h23xt//8eaFU8XBBocQfC9m8TKUf7q993b0v9PF/OistP/xHEU8fzwStf+JDY95+8LoNel4ogsIFVokivv1heyac06l0yptbB9jCuOO/esE6BLVh12z+3Clo1URoFIqgcIFVotDrb6yBVZ18sMGzTVDbNf/i337YNgStmrC/sr65BoNvvp4f9OWVgj78shoHbRSKoHBBVZ2bvhHUB8uPpqC+P1QcfPhH46Ur/vq/5kFf3r45DEUEdSBoK1k5yGSu26C3BXWR7rKT5EeU8h+/9mMCefvBK0Fpg+YI2oFXYu8FbfbiWyPo5u3HXbMN6hU/jVG1H7wW9EahqwNBW/GCWpWuxkHb26BXnaS8jJOuefnr2tAbB68FPS/UjrGuMYYiaCtlpXowZ0+S/sV+19mL/+L3+3ocs6ScF/JP54+Sbhy8IehZocdvmw/z1wKCTsfx21+89TsINQgKqkFQUA2CgmoQFFSDoKAaBAXVICioBkFBNQgKqkFQUA2CgmoQFFSDoKAaBAXVICioBkFBNQgKqkFQUA2CgmoQFFSDoKAaBAXVICioBkFBNQgKqkFQUA2CgmoQFFSDoKAaBAXVCAtqAHqRSlDZ7GCpICioBkFBNQgKqkFQUA2CgmoQFFSDoKCFm4OeCApKMPktLRAUdGDO/rw63PvzYiAoNJlWULu56Yv7pmVfUwSFJpMKun94zT+2bu9fBIUrWrtDE7VBj7tn96fdwxxB4ZLbKk7Yi//Yuuo9zzZvCAqXtFTmXYklE+ZVBC3IHhEULkkvaF2xf2wNgsIFCgQtevG+kj/uEBQuaWmDtqaVTZgkO5gVMd7kQFBIQWxB6STBKCaOoMNf1oN1QxUPqkFQUE0kQY87X5G3tEARFHoSaaDelI+SDtU3o7KDRRDU84j7qLNQdfM2OjtYBEOG55ufkk2YnyaLFBwYZgLHoAeclx+TTJgTQeEGmgStH8XTBoWq7alKUDuNydESPxF0RZiLr+Gflk2YJDvQSf3M0OSaevHTZwfqsDqOqNrrbMQTJskOtFG76cMmgoIiysr85Gb47UZQEMeUblaajpm7hqAgjQ+Z4R33q8xkEybJDhRRV+8mrON+nZlowiTZgSLKfrvMpHQEBXEEavZGXrIJk2QHepB9pQdBQYxaTcG7i6AghHt01Hh8JJKreMIk2UFqjO+2n/6Vylc8YZLsIDEueuY+fiIoaMP4fypHaYOCLkz5eNPV86KrciAoCFBW7BHWjEFQEKDqwUfIWTxhkuwgJfH0RFAYw2klONGee6MI8YRJsoMUmIahCAq6MGXVXo4szUjQ6qXjjuXDEHTmmCZ5rBVf40TQY9veCWHZgTYaYkbsIkWr4o+7R8nsQA+NqBl/wexYbdCDeen8OYLOlGn1pJMEQ7hodUZ20xcpnjBJdhCfqWNnWap4wiTZQVRMC1MULZ6wCfskzZw2N6faSGjiCDr1rwejSG1nThUPHaSW052DeMIk2YE8yYOnPwvxhI7jzv8y7JM0WzTYmccSlH2SZk9qPf9a0fcDQ06OXT5mTko1/3pB388Nm83EPklzJombLWJGqeKJoDNm6tB5KeZFyIzVBmWfpFkyZdXery6P1Itnn6T5MVWnaFgjk3FQsEzQab9Tl7edWN/sEXTB3NRT7BaF9sv9qYknTJIdhBPNzlFi1mcnnjBJdhDIbTvH+RlWl7edoHjCJNlBEMJ2SopZn6J4wiTZQQBidsYQsz5J8YRJsoOhSMgpWpe3nad4wiTZwRDGhs4pxKxA0JUxqlc0oZgVCLoi2uS8ezMSiFmBoCuhVc6uOzFlXd4Cgq6AdjnbbkN6MSsQdOF0yHnDTz1iViDokuktp4K6vAUEXSjdkbO+/GrFrEDQBdJDTvViViDowrgjp966vAUEXQ6DzEx9sn0JEPRj+5zvO97mkC0XerE4MSsCBM02b+9Pj3l2Z5FvoXLhDkupy1sYLqh96d0u8N32xrtwudDOIkPmBWGCZoWcbSt/Oo47f7VYmykS98VcyAqXIVX848d28/ax7ajiWZspHnfrcnc09VmKEdRJMg+vnfvMsLJIDO6HzJLUJypKlGEm1mYSpa+YS3PTwdpMiulTly9ZTkuIoEUdv3nLWhqXDtZmGsWAkLlgNT0Bgh4eXve2k9RlKGszDeZKu/tiLtxNx3BBbf1tK+7OYSa5cpfODenu1eVrcdMRNg5qBWWgfgQ3jesp5lrU9IRH0KzXw3g28jqnRbi+Yq7xogW3Qfd3tjNuyWWl13qkmCu7WucE9uKNeXidpty500dMzGyH+aDRIGRKEEnQ485f55VOFgkUM/VpaySOoOudLBJSl6c+Z9UMFLQagO+MjvlKH3UOC5mpz3YmMFlEht5ipj7RucFkkfH0q8tTn+VMidUGXclkEZ6Xx2ZwG/S5boZ2Pepc/GSRfv3y1Ge5ABgHHUa/fjluihEwWeQr/wxpZZNF+oqJmrKEC7qS6Xb9xUTOGAwVNDvdjK4Jy3LlpuKqLs8HrGYIYoRH0InKnZwbYnqwMwV0kipaxXTgZiICBD3u/J1ZSBv0Vl1+AXamI2RlkVFmDi03HvfF9OBmSkLeSRrVOxparjx9xXRgZ2LCXpqbsFw5etTll2BnckJemhu1MOjQcgUYLqYHORUQ8tJc0OtyoeWOIFRMC7FTCSFVfHm31PbiA+ryBrQ7FbGkcdCxYjqwUxeLEFRCTHdSbUieLAwiQNCqjk9fxUuJ6c8IOzUSMlC/eds/5u9Po7pKo267SF1+cT7YqZOwgfqDXd1u1EZJYXdeXszybNBTK2ED9e9ffnZfE5TriCWmPxXsVEzY6nZ2yt0Ugkaoy69OBDlVE9AGtVPps+e4VXx8McvTQE7lhAwzZY+2J9/Rie+x/khLuVOJWZ4EcqonzjjocXdvDOoiuwnq8hvngJ76iba63Z0ZJVV2KcQszwA950CsZ/H3ZpSkE9OBnXMhOIKOey0+T2Wmp7ISPdUTXsXPeL94oud8CBd0viuLYOeMCBe038oiCrehwc85ESxo537xguUKQ+0+M8J78aMeJKUQlJ77HJl4wnI6O9BznkQbqL8zVjqtH1d24udcCJnNZO/vw+vZQvRX6NqG5oae+DkXBgtaurc3c9mG5pae+Dkbhgp6qPbo3Jv2XrymbWjQc94MFLSeBFL05du78Voi6M3giZ6zYqCgdWzcb/7UMVCvYBuacyNRc76ECnrnUWfybWiclTw0mj+hVbzyySLnbubYOWOCO0nvP727VH3XQFRsQWl2LoTwYab76zakE7TZ+oxaFMQldKC+z5P4ZII2W58xS4LYxHwWn0pQY3NHzmWwSEGdmEbDRg0wlkUsv9jI2Lc9XT0P82dhglY9o5zqfSEsSdDSzpyBzwWxIEGN/8f4P+XzhxSECOomimTjtvOSF+hUu9M/WhABgh4eXvebt5EbzkkHZFepm/oZp2zukI6QgXq/9GK/145Hl9szNx80DcOfSyPkrc4XJ6iihRtM/S9yLo3wCJolWKO+PTPsXCjBbdA+s0Ukyu2bGV2jZRLYi7evdU5Tbp+8/KNN4ucSmf04KHYum7kLeuq/wyKZtaCnwU8EXSqDX5o7TQROPszkpywh6KKJFEH3hcCulx9xfdBT353++3KJI+i+6OP7BUQjC1pNXhqfG+gkeJipa5jeT6U/7joeiI5WqrISO5dN2EB97oNkG9XyDnbj7kiCmrMvWDAhjzpr+9rS1i8jZY+RBCV6roWAySJf+dDZNVmk0rJ9S08ZQcdlAjMgPIJ27nZcPak/tm3aiaDQi5A2qJMv8WQR2p8rIWQ+qMRYvVgvHpZN7EedETpJqLkm5vcsnsp9VQQIWtXxaZ7F0z1aFyG9+BHveoxac66avJQj6HoIe2nuLn6NRiO6kVc1OSTw4zBLwl6au0eMjbwqM2mDroqANuj9xb+jbENTh0568WsiRNCne52kKBt5UbevkpAq/u72HnE28qJuXyNxOklxNvKibl8hcTpJ6TfygoUQpZMkWS6smxGTRe4+SUq4kRcshZjP4hEURoOgoJqYk0VEBKXrvm4CBLXvaj7m7093R5skBGXwc+WEdJKe84N9432KBWx5fLR2wgbq37/87L6il4ugaydsoN6+eoygMAEBbVD7mlH2PE0VTxt07YQMM2WPHSsyiJdLL37VzO+lOVgVCAqqGSzo+9OznUWnaZcPWDBDBXXj83bxmx4D9SLlwroZKmhmp9NntoOU3Z1YL1IurJuBgro9jv1LH4r26oTlMljQl9JSBIUpCBHUNz+nGaiHlRPSBnXL0/d4uVOkXFg3QwU9PLx+bG3szO7X8F2DUQgKvRg8Dnpwr2q+P3VX8Jkxz++/eGt/RxlBoRdxniTZHUAyv1uN3MINsEaiCOq7Uu7tZLmlb2CVRBLU7TT3vzkRFEYSp4qvV6b3qo7NDtZLpNlM5UaJh9a9ahAUesF0O1ANgoJqYgsacb94WANEUFANgoJqJhZ01D5JsEIiCRpjnyRYI5EG6iPskwSrJIqgcXb5gDUSb7KIh8kiMAoiKKgmVhs0xj5JsEIi9eLZJwlkYKAeVMMuH6AaBAXVICioBkFBNQgKqqEXD6pBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqCaqoB1bdiMo9CLSyiKnVexYWQTGECeClus1EEFhLNEWbrBLNiAojCVaG9TuhIigMJZ4naS9eUZQGEvEXvz7008QFEYS97Xj1o3mEBT6wUA9qIaNvEA1RFBQDYKCatjIC1TDRl6gGjbyAtWwDQ2oho28QDVEUFANG3mBatjIC1TDQD2ohk0UQDUICqpBUFANgoJqEBRUQy8eVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVKNJUF5GhisUCWrkS4HZo0dQE6MYmDsICqpBUFCNHkFpg8INFAlKLx6u0SQowBUICqpBUFANgoJqEBRUg6CgGgQF1SAoqCaZoAC9SCToKKTOhXzmlU/6Qnqi7cKRzzT5pC+kJ9ouHPlMk0/6Qnqi7cKRzzT5pC+kJ9ouHPlMk0/6Qnqi7cKRzzT5pC+kJ9ouHPlMk0/6Qnqi7cKRzzT5pC+kJ9ouHPlMk0/6QgBCQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBpNgu6NeXgdn81xZ4xp39J+CO9ffh6bxUHml8pFTkbw4gjdrLsoEnT/6XN+GP9LH3dFHnvzKHBGH9tPY52wv5DALyVzMoIXR+hm3UePoB/bZ3sBR1+796eX3F/AsRTBb2wux52NVpnA/y0CJ5PLXRypm3UfPYI6xH5ngf+7D+b5MPZOiv3fInEyp8xkQt8aBd1L1RqZyN0cL+hPXyWykTmZGpmLI3ezulAl6EGqc2MDjkg2Y++kj1UyEUtMUJmLI3ezOlElqK01Nm8C2RxE+kgLFVTq4kjdrG6UCSpzL4Xi5zKreLGLI9aW7USFoPvT2JzvVYzLZz/2FtTno6eTJHEyjtEX54xRN6snKgR1+N9W4C7sjdhlG302csNMQoIKXRyxm3UXPYLmWdGi8Td0FO9PciFi/B2QG6gX0UHs4gjdrPsoEjTPipp1/P/fe7+Cr5Z+idwjQQlB5S6OzM26jyZBAa5AUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqELSNj61fx8h8+q9tz0WIDi/Fp26kPR083F8YqczkZkYrBEG78OvP9nWlNV31g+POrv/VvcJclRZBPQjahbCg5UK2neu+ImgTBO2iEvSfn/xag6ell/03H1/91u5e5A+/F4k2f9lW6eyiteUahaVsbnMhS/boD7k/6jS/KdoUL3Um7mdVefboJIsd6gNBu6gEtduzlV+ugj4Ya5DVzG4jUB2um472gLXRrqzsv3855Za7lT5rQU9pfAFVJvarytiF3MM6DUXQLipBn1297CNgYZdfWvhgbXquAmMpnf/ykfLjq1dfn5eC1istH7yH9vhZmqqQWtA64ymW2tYKgnZx1gYt/vCCFRL5RmRpU14frtw6b2MejOkUtJnGWVkLepbxeg1F0C4uBC3HnUpBS5vy+nAtaFWVF03IT388RdCbVXwjzYWgVcZ+j+JV1vAI2smtCJpX3fBmBC3TnUdQ9/dZFX/qJG3eqjybaW5F0Ipskt2v1YGgXTQFrUd+ztqgp4r6JGgloms6Hk5VvBtmOu42f3YdKt/kbKZpCtocaVrpuBOCdtEU1O+eaiPZqRfvBpXKw1a6uhd/3D36wGieT25lzlDjtnDZvBXfvTTTlD2j8168zdiF0kl2Z9cHgnZxIagbl3T9lWoc1JtXHc4uxkHdFjRZGWgdZbOySGyfpP7Gt0FPady408U4qA+xYpvZzA0ETcG365QtBAQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRU8//BAqqI+cPfWQAAAABJRU5ErkJggg==" /><!-- --></p>
<h1 id="pricing-abc-notes-with-monte-carlo-simulation-and-heston-model">Pricing ABC Notes with Monte Carlo Simulation and Heston Model</h1>
<p>As ABC Note has an Asian Option feature and thus it has no closed form solution. Hence, we need to use Monte Carlo Simulation to price the option. As discussed in the previous section, Heston Model will be the stochastic model used. This section will discuss how we should model the Bitcoin price method.</p>
<p>Before delving into the actual pricing, we need to find the parameter <em>κ</em> and <em>ξ</em> as they can’t be observed from historical data like other parameters in the Heston model. Hence, we present two approaches to estimate the two parameters:</p>
<ol style="list-style-type: decimal">
<li>Minimizing the sum of squared difference between Monte Carlo Simulated European option prices and actual options prices</li>
<li>Minimizing the sum of squared difference between simulated volatility and actual volatility</li>
</ol>
<p>For both methods, Q-Q plots of the simulated price and correlation between simulated and actual price are shown. The parameters calibrated by method 1 has higher correlation between simulated an actual price and create more significant heavy tails. Thus, <strong>the <em>κ</em> and <em>ξ</em> calculated by method 1 is chosen</strong>.</p>
<p>After determining the parameters, we can start pricing the ABC Note by Monte Carlo Simulation, which returns a value of <strong>~USD150,000</strong>. Undoubtedly, it is too pricy for an investor and thus reallocate the capital and the final product worth USD1000 which:</p>
<ol style="list-style-type: decimal">
<li>1% Management Fee</li>
<li>79.2% Risk-free bond</li>
<li>19.8% ABC Note</li>
</ol>
<h2 id="approximation-of-parameters-κ-ξ">Approximation of parameters: <em>κ</em>, <em>ξ</em></h2>
<p>Method 1: Minimizing the gap between actual option price and option price predicted by Monte Carlo of Heston Model</p>
<p>We have taken around 200 Bitcoin options data from the crypto exchange platform Deribit, including their prices, strikes, time to maturities, and option types. With these information, as well as the Bitcoin price data date till the options retrieval date (2021-11-17), we can run a Monte Carlo simulation using the Heston model to price each option and try to find the kappa and xi that minimize the sum of squared difference between all simulated option prices and actual option prices.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleaning the actual option data from Deribit </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Db <span class="ot">&lt;-</span> Db.option[,<span class="fu">c</span>(<span class="st">&quot;Expiry.Date&quot;</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Time.to.Maturity..Days.&quot;</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Type&quot;</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Strike&quot;</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Last.Price..USD.&quot;</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Volume&quot;</span>)] <span class="sc">%&gt;%</span> na.omit <span class="co"># subsetting the columns needed</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Db) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;T&quot;</span>,<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;K&quot;</span>,<span class="st">&quot;price&quot;</span>,<span class="st">&quot;Volume&quot;</span>) <span class="co"># renaming columns</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>Db <span class="ot">&lt;-</span> <span class="fu">subset</span>(Db,Volume <span class="sc">&gt;</span> <span class="dv">5</span>) <span class="co"># remove options that aren&#39;t frequently traded</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>Db<span class="sc">$</span>T <span class="ot">&lt;-</span> Db<span class="sc">$</span>T<span class="sc">/</span><span class="dv">365</span> <span class="co"># annualize the time to maturity</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># risk-free return of each option</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>Db<span class="sc">$</span>r <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">+</span> dtb3<span class="sc">$</span>DTB3[<span class="fu">length</span>(dtb3<span class="sc">$</span>DTB3)])<span class="sc">^</span>Db<span class="sc">$</span>T<span class="dv">-1</span>)<span class="sc">/</span>T<span class="sc">*</span><span class="dv">365</span> </span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The function &quot;heston&quot; can</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. return the sum of squared error between MC simulated option price </span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#    calculated by the kappa and xi got with each method and actual price</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Q-Q plot of the simulated Bitcoin price will also be returned</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. A vector of simulated price will be returned</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>heston <span class="ot">&lt;-</span> <span class="cf">function</span>(para, <span class="co"># para[1] - kappa; para[2] - xi</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> Db, <span class="co"># data for actual option price</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">qq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rf=</span>dtb3,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">voldf =</span> BTC.plot,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">retdf =</span> BTC.r){</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(data<span class="sc">$</span>Date) <span class="co"># number of options</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  kappa <span class="ot">&lt;-</span> xi <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># initializing the vector for kappa and xi   </span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  f.pre <span class="ot">&lt;-</span> f.total <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># initialize payoff vectors &amp; squared error vector</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  f.vec <span class="ot">&lt;-</span> <span class="fu">foreach</span> (<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>n)<span class="sc">%dorng%</span>{ <span class="co"># parallelization</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>      tr <span class="ot">&lt;-</span> data[k,] <span class="co"># for each option,</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>      K <span class="ot">&lt;-</span> tr<span class="sc">$</span>K <span class="co"># we get its strike,</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>      T.day <span class="ot">&lt;-</span> tr<span class="sc">$</span>T<span class="sc">*</span><span class="dv">365</span> <span class="co"># time to maturity (days)</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>      Type <span class="ot">&lt;-</span> tr<span class="sc">$</span>Type <span class="co"># option type,</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>      price <span class="ot">&lt;-</span> tr<span class="sc">$</span>price <span class="co"># and actual price.</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>      <span class="co"># then we set the Heston parameters</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>      d <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># There is around 120 options so there are ~6000 trials</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>      r <span class="ot">&lt;-</span> rf<span class="sc">$</span>DTB3[<span class="fu">length</span>(rf<span class="sc">$</span>DTB3)]<span class="sc">*</span><span class="dv">365</span> <span class="co"># current annualized risk free rate</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>      m <span class="ot">&lt;-</span> <span class="dv">365</span> <span class="co"># number of days in a year</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>      dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>m <span class="co"># time step - day</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>      f <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,d) <span class="co"># initializing the payoff vector of each simulation</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>      s <span class="ot">&lt;-</span> nu <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,T.day<span class="sc">+</span><span class="dv">1</span>) <span class="co"># initialize price and volatility vector</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>      s[<span class="dv">1</span>] <span class="ot">=</span> voldf<span class="sc">$</span>Ad[<span class="fu">length</span>(voldf<span class="sc">$</span>Ad)]<span class="sc">*</span><span class="dv">10000</span> <span class="co"># start from current price</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>      theta <span class="ot">&lt;-</span> (<span class="fu">sd</span>(retdf<span class="sc">$</span>.)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">365</span>)))<span class="sc">^</span><span class="dv">2</span> <span class="co"># annualized vol of return </span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>      nu[<span class="dv">1</span>] <span class="ot">&lt;-</span> theta </span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Next, we run the actual simulation</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){ <span class="co"># For each trials</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(T.day<span class="sc">+</span><span class="dv">1</span>)){ <span class="co"># For each time step</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Initializing the stochastic terms           </span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>          dWs <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(dt) <span class="co"># for stock</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>          dWt <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(dt) <span class="co"># for volatiltiy</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>          dnu <span class="ot">&lt;-</span> para[<span class="dv">1</span>]<span class="sc">*</span>(theta<span class="sc">-</span>nu[i<span class="dv">-1</span>])<span class="sc">*</span>dt<span class="sc">+</span>para[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(nu[i<span class="dv">-1</span>])<span class="sc">*</span>dWt <span class="co"># dv </span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>          ds <span class="ot">&lt;-</span> r<span class="sc">*</span>s[i<span class="dv">-1</span>]<span class="sc">*</span>dt <span class="sc">+</span> <span class="fu">sqrt</span>(nu[i<span class="dv">-1</span>])<span class="sc">*</span>s[i<span class="dv">-1</span>]<span class="sc">*</span>dWs <span class="co"># dS </span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Recording the volatility and price of each time step</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>          nu[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(nu[i<span class="dv">-1</span>]<span class="sc">+</span>dnu,<span class="dv">0</span>)</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>          s[i] <span class="ot">&lt;-</span> s[i<span class="dv">-1</span>]<span class="sc">+</span>ds</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculating the payoff for the options according to its type</span></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (Type <span class="sc">==</span> <span class="st">&quot;C&quot;</span>){ <span class="co"># call</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>          f[j] <span class="ot">&lt;-</span> <span class="fu">max</span>(s[T.day<span class="sc">+</span><span class="dv">1</span>]<span class="sc">-</span>K,<span class="dv">0</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>T.day<span class="sc">/</span><span class="dv">365</span>)</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span>{ <span class="co"># put</span></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>          f[j] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="sc">-</span>(s[T.day<span class="sc">+</span><span class="dv">1</span>]<span class="sc">-</span>K),<span class="dv">0</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>T.day<span class="sc">/</span><span class="dv">365</span>)</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(qq<span class="sc">==</span><span class="cn">FALSE</span> <span class="sc">&amp;</span> plot<span class="sc">==</span><span class="cn">FALSE</span>){ </span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>          <span class="co"># squared difference between predicted and actual price</span></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>          (<span class="fu">mean</span>(f)<span class="sc">-</span>price)<span class="sc">^</span><span class="dv">2</span>}<span class="cf">else</span> <span class="cf">if</span>(qq<span class="sc">==</span><span class="cn">TRUE</span> <span class="sc">&amp;</span> plot<span class="sc">==</span><span class="cn">FALSE</span>){ </span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>              <span class="co"># simulated ABC Note payoffs</span></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mean</span>(f)}<span class="cf">else</span> <span class="cf">if</span>(qq<span class="sc">==</span><span class="cn">TRUE</span> <span class="sc">&amp;</span> plot<span class="sc">==</span><span class="cn">TRUE</span>){ </span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>                <span class="co"># simulated Bitcoin prices</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>                s}</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (qq <span class="sc">==</span> <span class="cn">TRUE</span>){</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(f.vec <span class="sc">%&gt;%</span> unlist) <span class="co"># return a vector of simulated prices</span></span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(f.vec <span class="sc">%&gt;%</span> unlist)) <span class="co"># return the sum of squared error (SSE)</span></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we find the kappa and xi which minimize the sum of squared error</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>opm <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="fl">1.3</span>, <span class="dv">9</span>), <span class="co"># Initial Guess</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>             heston, <span class="co"># SSE between simulated and actual price</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>Db) <span class="co"># data input</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>k.m1 <span class="ot">&lt;-</span> opm<span class="sc">$</span>par[<span class="dv">1</span>] <span class="co"># optimized kappa by using method 1</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>x.m1 <span class="ot">&lt;-</span> opm<span class="sc">$</span>par[<span class="dv">2</span>] <span class="co"># optimized xi by using method 1</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Kappa:&quot;</span>,k.m1,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Kappa: 1.3</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Vol of vol:&quot;</span>,x.m1,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Vol of vol: 9.9</code></pre>
<p>QQPlot and Error plot of method 1</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q-Q plot of a sample simulated Bitcoin price trials is shown. </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>f.pre1 <span class="ot">&lt;-</span> <span class="fu">heston</span>(<span class="at">para =</span> <span class="fu">c</span>(k.m1, x.m1), <span class="co"># kappa and xi calculated by method 1</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> Db,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">qq =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>s.pre1<span class="ot">&lt;-</span> <span class="fu">heston</span>(<span class="at">para =</span> <span class="fu">c</span>(k.m1, x.m1), <span class="co"># stock price sample by method 1</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> Db,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">qq =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot=</span><span class="cn">TRUE</span>) </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Q-Q plot</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># We plot QQ plot of the simulation </span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>s.r <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(s.pre1)) <span class="sc">%&gt;%</span> na.omit</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(s.r)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(s.r, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAzFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmZgBmZjpmkGZmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQ27aQ2/+2ZgC2Zjq2ZpC2kGa225C227a22/+2/7a2///bkDrbkGbbtmbbtpDb25Db27bb29vb2//b/7bb/9vb///fU2v/tmb/25D/27b//7b//9v////riG70AAAACXBIWXMAAA7DAAAOwwHHb6hkAAASJ0lEQVR4nO3di3rjxmGG4dHGbCQnTVLR7imNpZ4SwWnqLhrHbapSJnH/9xTMDACCFEkBg8P8wHyvH+9uuBAAS18GB4KAKQBhJvYKALcQKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKQR6FWZMU/lb/utue/9tYdns3lt/sf3f2uM+etvXk+mePdibrxffHf29dUX/P5z79VYAQK9qgzURjI40P3XVXlffHec4MKLdaDm7uVCoD9+/YlA0VYGaofQoYGWf6wdE7v0YhNo+aXvA80MgeJE5uupA7Wb5J/82laTm7t//9p8+s/yL77/ubn7pvjvB/PFi5vGjou/eDkJtOzuzm7Iv38w5rGe96UXc5/gj9tyCK2/vllodhp4Ogj0KtfEYx1oXg9u9R83f95WA97P63h2FzbR5Z/uXLx2Rq1R9f2LVaC2/zrQ40IJFOfKjerflU34QN8ebCa5G+/KXzffFf9T/kX5v/5YhvON/4uyqp++2ikfW4G29hCyusrLL1aB/rAtf/df314om3icKZP4Qxmbj6nqw/2WN4f3ZT7+V1el9cN/lOPpfSvQ5m/80Fhcf/H9Pmh7oQSKMzaJcnz73bYVnMupasqX2wywZXGHf/GB3QjUDrtm86ebgda7CCcLJVCcsUmUef2VLbDeJu/s4HktUHto/sW//bA9CbTehf0b25vbYfC7r+0X/fKqQO9+VZ8HPVkogeJMvTk3XUdQP1juTwP1x0Pli3d/b3x05W//d/qiX15+ehqKEdQh0Kuy6iSTeb8PejlQN9KdHyT5M0rFj1/7cwLF9RffBco+aEGgN/gkch/o6VH81RF08/rj8+k+qE/8eI7q+ovvA72w0OQQ6FU+UJvSu/Og1/dB3x0kFdU46XYvf90UeuHF94G2F7rjPChOVRvVnWm9k/RP9k83j+K/+G3enMesVNeF/EP7raQLL14ItLXQw7enb+angkDnc/j2l6/dXkSDQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCGNQCFt5EAN0EmsQMedHdaKQCGNQCGNQCGNQCGNQCGNQCGNQKHi4klPAoUIU1zKgkChwbR+ffdy56/vZWeuP9eUQHFq3kAzYx7ffvla7LdPY8wO6zdroJl9hrkbPfPN5QdMEijOzLgP6sbNty9toLvTJ0P3v0gFyZjvKH6/tQ+OPvxvwQiKgabZxOf1uOlTHTo7pGuig6TcH77vzJVjJAJFN5wHhTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChbSJAs2NMU/uD58+jzA7JGuaQPO7l2K/vS8IFANNEujh+dH9unklUAwzSaD7rdu8F9nm9SxQ0+gxOyRswhG0lN0zgmKQifZBqyz3W0OgGGKyo3i/kT88EyiGCAh0v320p5HKI6A5lou0BQRaHvq8PdyX+5ezLBdp6x+oPUTflVvw3ZWN98jLRdrCAs3KOK8dn4+8XKQtZBN/v99uXv0bRdMvF2kLOkgydy+H50F9Eii64WomSCNQSAsJtNzGb16zx3mWi7QFBLq7e8ntQdKgQgkUnfQP1F4Jkt+4kG7k5SJtYedBbaCcqMcMwkfQbNCb8QSKToL3QevrlaZeLtap6zXrgUfxxty99F6noOVilUzRsQHOgyIC0/q1y5Rj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" /><!-- --></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The function plot actual option price against simulated (predicted) price,</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># if actual and simulated prices are the same, all points should lie on</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the red line.</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation between actual and simulated price is also returned </span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>act_pre_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(f.pre,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                         data,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">p =</span> <span class="dv">800000</span>, <span class="co"># boundary of the simulated price </span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">a =</span> <span class="dv">800000</span> <span class="co"># boundary of the simulated price</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                         ){</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Merging actual price and simulated price into a dataframe</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> <span class="fu">cbind</span>(f.pre, data<span class="sc">$</span>price) <span class="sc">%&gt;%</span> data.frame </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(j) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Predicted&quot;</span>, <span class="st">&quot;Actual&quot;</span>) <span class="co"># renaming the dataframe</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  j.s <span class="ot">&lt;-</span> <span class="fu">subset</span>(j, Predicted <span class="sc">&lt;</span> p <span class="sc">&amp;</span> Actual <span class="sc">&lt;</span> a) <span class="co"># Subsetting simulated price</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Correlation:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cor</span>(j))</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting the actual price and predicted price</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(j.s,<span class="fu">aes</span>(<span class="at">x=</span>Predicted,<span class="at">y=</span>Actual)) <span class="sc">+</span> </span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Actual Price against Predicted Price&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">hjust =</span> .<span class="dv">5</span>)) </span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting actual price against predicted price, as well as their correlation</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">act_pre_plot</span>(<span class="at">f.pre =</span> f.pre1, <span class="at">data =</span> Db) </span></code></pre></div>
<pre><code>## Correlation: 
##           Predicted    Actual
## Predicted 1.0000000 0.4814905
## Actual    0.4814905 1.0000000</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Method 2: Minimizing the actual 30 day volatility and predicted volatility from Monte Carlo of Heston Model</p>
<p>As we can estimate the actual volatility by using 30-day volatility, we tried to find the kappa and xi that minimize the sum of squared error between simulated volatility by using Heston Model and the actual 30-day volatility.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframes created here will be useful in</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># approximating parameters, backtesting, and product variants</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the strike price in each month (mean of the previous month prices)</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>short_d <span class="ot">&lt;-</span> <span class="fu">substr</span>(BTC<span class="sc">$</span>Date,<span class="dv">1</span>,<span class="dv">7</span>) <span class="co"># only get the year and month</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>btc.K <span class="ot">&lt;-</span> <span class="fu">cbind</span>(BTC,short_d) </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(btc.K) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Date&quot;</span>, <span class="st">&quot;S&quot;</span>,<span class="st">&quot;short_d&quot;</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> btc.K <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(short_d) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">K =</span> <span class="fu">mean</span>(S)) <span class="co"># monthly mean</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">cbind</span>(group[,<span class="st">&quot;short_d&quot;</span>],<span class="fu">lag</span>(group[,<span class="st">&quot;K&quot;</span>])) <span class="sc">%&gt;%</span> na.omit </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># merge mean price with the price data, also omit NA</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>btc.K <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> btc.K, <span class="at">y =</span> group, <span class="at">by =</span> <span class="st">&quot;short_d&quot;</span>, <span class="at">all.x=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> na.omit </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge strike, riskfree, price, return, and volatility datframe together</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co"># note that BTC.plot is the dataframe for plotting price, ret, vol before</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>bt.btc <span class="ot">&lt;-</span> <span class="fu">list</span>(btc.K,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>               dtb3,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>               BTC.plot[,<span class="fu">c</span>(<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;vol&quot;</span>)]) <span class="sc">%&gt;%</span> <span class="fu">reduce</span>(left_join, </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">by =</span> <span class="st">&quot;Date&quot;</span>) <span class="sc">%&gt;%</span> na.omit</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing dS and dv data in the Heston Model</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>sv_lag <span class="ot">&lt;-</span> bt.btc[<span class="fu">c</span>(<span class="st">&quot;S&quot;</span>,<span class="st">&quot;vol&quot;</span>)] <span class="sc">%&gt;%</span> lead </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sv_lag) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;S1&quot;</span>,<span class="st">&quot;v1&quot;</span>) <span class="co"># naming lagged data</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>bt.btc <span class="ot">&lt;-</span> <span class="fu">cbind</span>(bt.btc,sv_lag) <span class="sc">%&gt;%</span> na.omit <span class="co"># combine lag and non-lag data</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>bt.btc<span class="sc">$</span>dS <span class="ot">&lt;-</span> bt.btc<span class="sc">$</span>S1 <span class="sc">-</span> bt.btc<span class="sc">$</span>S <span class="co"># their difference is dS</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>bt.btc<span class="sc">$</span>dv <span class="ot">&lt;-</span> bt.btc<span class="sc">$</span>v1 <span class="sc">-</span> bt.btc<span class="sc">$</span>vol <span class="co"># and dv</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(bt.btc<span class="sc">$</span>Date) <span class="co"># Checking the number of rows</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>bt.btc<span class="sc">$</span>dt <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">252</span>,n) <span class="co"># creating dt column</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> (<span class="fu">sd</span>(BTC.r<span class="sc">$</span>.)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">252</span>)))<span class="sc">^</span><span class="dv">2</span> <span class="co"># long run volatility</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>bt.btc<span class="sc">$</span>theta <span class="ot">&lt;-</span> <span class="fu">rep</span>(theta,n) <span class="co"># creating theta column</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">252</span> <span class="co"># time step</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>bt.btc<span class="sc">$</span>dWs <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(dt)<span class="sc">*</span><span class="fu">rnorm</span>(n)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">252</span>) <span class="co"># modelling the stochastic term</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>bt.btc<span class="sc">$</span>dWv <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(dt)<span class="sc">*</span><span class="fu">rnorm</span>(n)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">252</span>) <span class="co"># modelling the stochastic term</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bt.btc) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;short_d&quot;</span>,<span class="st">&quot;Date&quot;</span>,</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;S&quot;</span>,<span class="st">&quot;K&quot;</span>,<span class="st">&quot;r&quot;</span>,<span class="st">&quot;v&quot;</span>,</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;S1&quot;</span>,<span class="st">&quot;v1&quot;</span>,<span class="st">&quot;dS&quot;</span>,<span class="st">&quot;dv&quot;</span>,<span class="st">&quot;dt&quot;</span>,</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;theta&quot;</span>,<span class="st">&quot;dWs&quot;</span>,<span class="st">&quot;dWv&quot;</span>) <span class="co"># renaming the column names</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Only get data column needed</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>bt.btc <span class="ot">&lt;-</span> bt.btc[<span class="fu">c</span>(<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;dS&quot;</span>,<span class="st">&quot;r&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;K&quot;</span>,<span class="st">&quot;v&quot;</span>,<span class="st">&quot;dt&quot;</span>,<span class="st">&quot;dv&quot;</span>,<span class="st">&quot;theta&quot;</span>,<span class="st">&quot;dWs&quot;</span>,<span class="st">&quot;dWv&quot;</span>)] </span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>bt.btc<span class="sc">$</span>r <span class="ot">&lt;-</span> bt.btc<span class="sc">$</span>r<span class="sc">*</span><span class="dv">252</span> <span class="co"># annualizing the risk-free rate</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The sum of squared error between simulated and actual volatility</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>heston.v <span class="ot">&lt;-</span> <span class="cf">function</span>(param,btc){</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>((param[<span class="dv">1</span>]<span class="sc">*</span>(btc<span class="sc">$</span>theta<span class="sc">-</span>btc<span class="sc">$</span>v)<span class="sc">*</span>btc<span class="sc">$</span>dt <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>         param[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">sqrt</span>(btc<span class="sc">$</span>v)<span class="sc">*</span>btc<span class="sc">$</span>dWv<span class="sc">*</span><span class="fu">sqrt</span>(btc<span class="sc">$</span>dt)<span class="sc">-</span>btc<span class="sc">$</span>dv)<span class="sc">^</span><span class="dv">2</span>)}</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trying to Monte Carlo the parameters</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># trials</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> xi <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,d) <span class="co"># initializing the list for kappa and xi</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  bt.btc<span class="sc">$</span>dWs <span class="ot">&lt;-</span> bt.btc<span class="sc">$</span>dWv <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">252</span>) <span class="co"># stochastic term</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="fl">1.3</span>, <span class="dv">9</span>), </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>                  heston.v, </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">btc =</span> bt.btc,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lower=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&quot;L-BFGS-B&quot;</span>) <span class="co"># optimization</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  k[i] <span class="ot">&lt;-</span> result<span class="sc">$</span>par[<span class="dv">1</span>] <span class="co"># result of the optimization: kappa</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  xi[i] <span class="ot">&lt;-</span> result<span class="sc">$</span>par[<span class="dv">2</span>] <span class="co"># result of the optimization: vol of vol</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>k.m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(k) <span class="co"># optimized kappa by using method 2</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>x.m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(xi) <span class="co"># optimized xi by using method 2</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Kappa:&quot;</span>,<span class="fu">round</span>(k.m2,<span class="dv">4</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;Standard Error:&quot;</span>,<span class="fu">sd</span>(k)<span class="sc">/</span><span class="fu">sqrt</span>(d),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Kappa: 5.3106     Standard Error: 0.009679367</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Vol of vol:&quot;</span>,<span class="fu">round</span>(x.m2,<span class="dv">4</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;Standard Error:&quot;</span>,<span class="fu">sd</span>(xi)<span class="sc">/</span><span class="fu">sqrt</span>(d))</span></code></pre></div>
<pre><code>## Vol of vol: 0.0022    Standard Error: 3.158368e-05</code></pre>
<p>QQPlot and Error plot of method 2</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q-Q plot of a sample simulated Bitcoin price trials is shown. </span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>f.pre2 <span class="ot">&lt;-</span> <span class="fu">heston</span>(<span class="at">para =</span> <span class="fu">c</span>(k.m2, x.m2), <span class="co"># kappa and xi calculated by method 2</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> Db,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">qq =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>s.pre2 <span class="ot">&lt;-</span> <span class="fu">heston</span>(<span class="at">para =</span> <span class="fu">c</span>(k.m2, x.m2), <span class="co"># stock price simulated by method 2</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> Db,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">qq =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot=</span><span class="cn">TRUE</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co"># We plot the QQ plot of the simulation </span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>s.r2 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(s.pre2)) <span class="sc">%&gt;%</span> na.omit</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(s.r2)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(s.r2, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting actual price against predicted price, as well as their correlation</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">act_pre_plot</span>(<span class="at">f.pre =</span> f.pre2, <span class="at">data =</span> Db)</span></code></pre></div>
<pre><code>## Correlation: 
##           Predicted   Actual
## Predicted  1.000000 0.461307
## Actual     0.461307 1.000000</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAABI1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYzMzM6AAA6ADo6AGY6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOgBmOjpmZgBmZjpmZmZmkJBmkLZmkNtmtttmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQZjqQkDqQkGaQtpCQttuQ27aQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2Zjq2Zma2ZpC2kDq2kGa2kJC2tma2tpC2ttu229u22/+2/9u2///Ijk3I///bkDrbkGbbtmbbtpDb27bb2//b///fU2vkq27k///r6+v/tmb/trb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///9xYFI0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAflklEQVR4nO2deYPcxnHFeymK2jh2rHAoipEdJRF1kNIyhyPa3lUS57Ai7oaSCVKbpbIXvv+nCIDBzACY7kYfVd1V6Hp/cEhi5vWb6t8AjauhapGIsFTuACKRTSp3AJHIJpU7gEhkk8odQCSySeUOIBLZpHIHEIlsUrkDiEQ2qdwBRCKbVO4ANl09Ugdfmxbe/Ot3swZvD9XjkV2vd375reV9cHLyHX8Rc0iTzrsi6ZuyF+l8VN705XGRytWwi86aYt03LHt5eCcc0KlvTkAnX8Qc0iQLoDNFMgGaqjwuUrkadtDNM/WxMlX4zLhkoD1A+7r/9Myyak6syRfxD3lufttMkfYAJVgelTuARW8PD/75kem3GwVo+9d78QFBZATUNSQ8oJTKo3IHsOhMvfvqxFSpOEDdPp5EZkAdQyIASqg8KncAs7qCjWr48s+VOvjbV3Vb2k6Pdwhu3vh/f/h5s+BgPcw3A9q9/e3hnf/+Rqm7X2/ft2uh1Q+/aqx+8ZtJrlELzUDkD81nfvFts7o3td/++VNrtflI5/vO+IvMh9wL1LV899vJGFRTJPsngcsDLIVrH6OuSIOqNUPSTu++sgB6frgZ5rf/PQ/or5t33vmuf9+whUbfqNE/N58ctbD9zN8cGttv/vx4/d9rHs76d7QrKSdAf92/eRzo6qP1vz4eAqotkv2TsOWBlsI0j9NJ99VPtgU4UeovX9Uv+z3MfiM0AbQp8rvNaurm5WG3eGYT3yxuLG/+a/O+aQvtv27+53A0ypi00Hzm4O+azxwqc/ttM3f/WN/8m+qcmn++33yl73vfuU38NuQ0UNPyJ53NEFBtkeyfBC0PuBSmeZT6ep1vVi9NlYZF1wO67e0zzbGXvb2AZvGa/i1Igxaaf30ycN7I0ELzamz/bc9y08Pt61nf6PiLOIUcBtoUpm9Z9xUGRbJ8ErQ84FKI3nE6Xxd3u0O56cgeCT2gg0/bAP3+o83i9X+s3zdu4Wyw6tatIza/iP5dJ+b2t82c94COiDQCOg05CXQybln3FXac2j6JUx4oKUTvKDUDnjGYkzpYAL354T//WukB3epgNERd/2XUQtP+Zn1ytjfM2rawTWlrf5LxvN1B+tP0i8yGnASatqz5ChvvmU/ClwdSCs86TsPqtKXYlXUtE6Df/2pTYwugP18DMu6BcQuj8yojhIYt7NY6m714TfvTjCfd4l/+cfRFZkNOAu1aHgCqL9LMJ4HLAyyFZx2ns0EB2l/o4CfbL9cCuu78v/jNS/sYdK29Hrg/erO+B0Yt7AGqa3/vR9QerWnf9sngi8yGNGK2blnzFWYB3fyoIMsDLYVnHaXNIY3tyshtDdpgvV4z2cegvWZWEdoz4eMWpp2tbV8zDLn5925FOxgnzoacLDABql+D2j4JWh5wqSSt+GuA1tv1gYzNEKgvlBbQXRFn9uInjYwHWZ3LtK97TVqYjOf07Rt25F6ud5JdAZ0Eso9BR0Wa+SRkeeClkrTir5NdtzW1GO789nWcAnoyWqHdPAsAdNzCiXbLNW1hvEesb9/8I9Ls1JtDTgKd2fbix0WyfxKyPPBSKRrx1+hqhTNlPsS3eeP60tFt558bdpKsPbB3oG+0NqrH/5i0sD6mqF9qOlZ74rUGnQbapHU7Dmr5JGR54KUQvSN0Pjn7tz6n1O5VvOzLtNk8rU9vfP+R6ldo3emNb/oBnh+gkxZO1ifPf/ho1I2TFiZnZbTtTwBtYtxtxqntmx7X0+2sJeQ0UP/Np2eSDEUyfxK0POBSiN4RGm9ATja7Sdt9+q5o3Tm3n9a7k3f+Y9P5ne7+U1dGT0DHLdxsTjYfDDymLWw+c/Cxuf3pGHR7vv794ReZDTkNNG5Z+xU23tZPgpYHXArTPFiT6xHP+x5sD8+880n/n+3p7/Z/f/r7Zkv1/qu+82++OewuFNpuzHwAnbSwPqb5zvt/Gn1o3ML2aqb+xJeu/b2dpDby7kDo5ovMhdwP9NJ0NdNekWyfhC0PtBSq+/K13Uk6J3MF5bKkcgdgrrN+JZTssEtpUrkDMFez9bv7bbvRpnMXz7Kkcgfgrs0p2YNP5t8r8pfKHYC9uj0e13vYRb5SuQOIRDap3AFEIptU7gAikU0qdwCRyCaVO4BIZJPKHUAkskkBePxolm1ZkKANlxiwgjZM6tcbCqA4fgQC2vkkENDJUADF8csfcIbP/AHdDAVQHL/sAef4zB7Q0VAAxfHLHXCWz9wBXQ0FUBw/CQhkKIDi+GUOOL8C5VJBARTHL29ABz65VFAAxfHLGtCFTy4VFEBx/HIGdOKTSwUFUBy/jAHd+ORSQUhARRRU5Q6AIwXgkf7nRdcvW0DH9SebCgqgOH65AjrzyaWCAiiOX6aA7nxyqaAAiuOXJ6AHn1wqKIDi+GUJ6MMnpQoqpYyGAiiOX46AXnwSqmA34YXJUADF8csQ0I9PQhUUQDP4pQ/oySehCgqgGfySB/Tlk1IFZQya3i91QG8+uVRQAMXxSxzQn08uFRRAcfzSBgzgk0sFBVAcv6QBQ/jkUkEBFMcvZcAgPrlUUADF8UsYMIxPLhUUQHH80gUM5JNLBQVQHL9kAUP55FJBARTHL1XAYD65VFAAxfFLFDCcTy4VFEBx/NIEjOCTSwUFUBy/JAFj+ORSQQEUxy9FwCg+uVRQAMXxSxAwjk8uFRRAcfzwA0byyaWCAiiOH3rAWD65VFAAxfHDDhjNJ5cKCqA4fsgB4/nkUkEBFMcPNyAAn1wqKIDi+KEGhOCTSwUFUBw/zIAgfHKpoACK44cYEIZPLhUUQHH88AIC8cmlggIojh9aQCg+uVRQAMXxwwoIxieXCgqgOH5IAeH45FJBARTHDycgIJ9cKiiA4vihBITkk0sFHQC9/HS1Oqrr66erh28MLwIoumENzCeXCs4Dev3lcX352fHt86P69Ye19kUAxTesgfnkUsF5QC9aAF8cXX91Wl9+fqp9EUDxDWtgPrlU0GETv16LXn7xxvjSvOO9RlYLUZwW+nwuZynbwtvnT+qLhx2L2pf+bel/XnT9oA0r6gFzrkGvnz5pdpXsa1ABFNWwoh4w7178UUupjEHzGVbUAyL4OQO65rPbzHf77ZoXARTXsAL268SkgvOAvl61OpLjoNkMK2C/tZhU0GET76z06en6ARpWwH69mFRQAMXxgzOsgP02YlJBARTHD8xwc3yebEAsPwEU1Q/KcHv+iGpAND8BFNUPyHB3fpNoQDw/ARTVD8ZwcP6dZkBEPwEU1Q/EcHh9CMmAmH4CKKofhOHo+iWKAVH9BFBUPwDD8fV1BAPi+gmgqH7xhpPrP+kFRPYTQFH9og2n1yeTC4jtJ4Ci+sUa7l0/Ty0gup8AiuoXabh/fwexgPh+AiiqX5yh5v4jWgET+AmgqH5Rhrr740gFTOEngKL6xRhq79+kFDCJnwCK6hdhqL+/mFDANH4CKKpfuKHh/nc6ARP5CaCofsGGpvkZyARM5SeAovqFGhrnD6ESMJmfAIrqF2hont+GSMB0fgIoql+YoWX+JRoBE/oJoKh+QYa2+cFIBEzpJ4Ci+oUYWuevoxAwqZ8AiuoXYGifX5FAwLR+Aiiqn7/hzPyf+QMm9hNAUf28Defmp80eMLWfAIrq52s4O39y7oDJ/XgAqpSCNTQpc//Pz+8tgFIEVCkToUzK6yiH+ecFUAE0m6HL8xEEUAE0l6HT8zsEUIqAFjEGdXu+jABKEtBkhvkCOj7/qNQKQgIqClDpzz9ylQLwSP/zouvnauj8/LhSKyiA4vhJQCBDARTHz9HQ/QGcpVZQAMXxczP0eEBsqRUUQHH8nAx9HmBcagUFUBw/F0OvB2yXWkEBFMfPwdDvAfClVlAAxfGbN/Tjs9gKCqA4frOGnnwWW0EBFMdvztCXz2IrKIDi+M0YevNZbAUFUBw/u6E/n8VWUADF8bMaBvBZbAUFUBw/m2EIn8VWUADF8bMYBvFZbAUFUBw/s2EYn8VWUADF8TMaBvJZbAUFUBw/k2EonykCGm8AC/SLlACK6WcwDOYzQUDzLbRhfrESQDH99IbhfAqgAii+YQSfAqgAim4Yw6eMQQVQbMMoPoutoACK47dvGMdnsRUUQHH89gwj+Sy2ggIojt/UMJbPYisogOL4TQyj+Sy2ggIojt/YMJ7PYisogOL4jQwB+Cy2ggIojt/QEILPYisogOL4DQxB+Cy2ggIojt/OEIbPYisogOL4bQ2B+Cy2ggIojt/GEIrPYisogOL49YZgfBZbQQEUx29tCMdnqRUUQJH8OkNAPgutoCOgl5+f1vXr1Wr1wWl9/XT18E09eRFAdYaQfJZZwR/dAL1owaxfHLV/v31+VL/+cPIigOoMQfkssoLdn/OAvnjw+2YNevvb4/Yf11+dtivU8YsAqjGE5bPECq7/dN3ENxvz1eqovvziTX395fH4pXnLe41sFsVJHtAFK2Vb2AJ6+dlxuxa9eNghOX7p35b+50XXr6IekHwFvXeSWr04Mq1BBdCRKuoByVcwFFAZg7qooh4QwTA3oO3W/PZ3p7fPn6x334cvAuhYFbQhgh+XgO5r0Ner1YPj6QFQOQ6qUQVtiOHHJaAToI5Kn56kXwVtiOLHJaAACu1XQRvi+HEJKIAC+22Oz5MNiGUogKIaQvltzx9RDYhmKICiGgL57c5vEg2IZyiAohrC+A3Ov9MMiGgogKIagvgNrw8hGRDTUABFNYTwG12/RDEgqqEAimoI4De+vo5gQFxDARTVMN5vcv0nvYDIhgIoqmG03/T6ZHIBsQ0FUFTDWL+96+epBUQ3FEBRDSP99u/vIBYQ31AARTWM89Pcf0QrYAJDARTVMMpPd38cqYApDAVQVMMYP+39m5QCJjEUQFENI/z09xcTCpjGUABFNQz3M9z/TidgIkMBFNUw2M80PwOZgKkMBVBUw1A/4/whVAImMxRAUQ0D/czz2xAJmM5QAEU1DPOzzL9EI2BCQwEU1TDIzzY/GImAKQ0FUFTDED/r/HUUAiY1FEBRDQP87PMrEgiY1lAARTX095uZ/zN/wMSGAiiqobff3Py02QOmNlw0oEqpoPRw8vWbnT85d8DkhksGVClvQjOXd35+byb9T9dPAI3wc5h/nkn/0/UTQMP9XJ6PwKT/6fpRApTZGNTp+R1M+p+uHylAQ9Nn8XN7vgyT/qfrJ4AG+jk+/4hJ/9P1E0DD/Fyfz8Wk/+n6IQBaguT5XJmkADzS/7yS+7k/35DJCoqun2ziA/w8nr/JpP/p+gmg/n4+z4dl0v90/QRQbz+v5xcz6X+6fiZArx6pje58J4AO5Pd8bSb9T9dP1qCefp7Pf2fS/3T9BFA/P08+ufQ/XT8boG8PZRM/kS+fXPqfrp8F0Jtn92+ePb569FjWoHQMSw2oA7RF8+R+ff7uKwG0l/cKlEv/0/WbAfTsXn0um/iN/Pnk0v90/Wxj0JOOzjNZg/YK4JNL/9P1swHaDELrE3XwtR+fiwU0hE8u/U/XTw4zufoF8cml/+n6CaCOfmF8cul/un7WnSQ51blVIJ9c+p+u3+wa9OqvZAwazieX/qfrN7+Jl+OgEXxy6X+6fg6Awm7i/W8tnk+P7RfOJ5f+p+s3D+gJ6Bo0YHKG+fTIfhF8cul/un7zO0mwx0EZAhrDJ15AqDIyBjRU1sb4ARrFJ1pAsDoyBrS/jqnwMWgcnwIokGE6QDHSI/pF8imAAhnuA3q2vSfpnh+fiwI0lk8ZgwIZWtag3kqfHs0vmk8u/U/XT87FW/zi+eTS/3T95i63u3nmu4VfDqAAfHLpf7p+NkBP7nWUljoGheCTS//T9ZO9eJMfCJ9c+p+unwBq8IPhk0v/0/WzbeLPWjSvHt3343MZgALxyaX/6fpZ9+LP28OgvnwuAlAoPrn0P10/Ocyk8wPjk0v/0/VzAPRfihuDwvHJpf/p+s0BevWovHuSAPnk0v90/eyAtifkvc93pk8P6wfJJ5f+p+tnPcw0uVLk8vPTur5+unr4xvCyCEBB+eTS/3T9bFczHXy9PpnU62L1wWl9+/yofv2h/mURgMLyyaX/6fqZAO2P0g8AffHg980a9Pqr03ZNqn1ZAqDAfHLpf7p+xjXoeTf8PJlu4i+/eFNff3msfWne8l4j3biUi+QBXcSlBn+/eaYZg1487FjUvvRvS//zAlNFPSD5Cibeiz8f7cU7rEF5A1pRD0i+gumPgzar0e1x0MuFj0Er6gER/LgENALa6H+HgN4+f7Leb9e8MAe0AvbrxKT/6fr5nItf9nHQCthvLSb9T9dPLhbpVQH79WLS/3T9BNC1KmC/jZj0P10/AbTT5vg82YBYflwCFg7o9vwR1YBoflwCEgA0aKoMmHLszm+W2v90/cgAGjbZEEg5BuffS+1/un4C6Oj6JYb9HzlJkwDqmD4boKPrl/gBGjvNnQA6kLWUmcag4+vroMsLOxvqjwIoKqDAsyvv0kdocv0ncHnhv7EAWhag0+uT+QEqY9AlA7p3/TxDQIkZcgYUfkQWWY79+zvYjEHBjAXQBOkDpbn/iFZAsx/cqlkATZA+TLr740gFtPgJoMsHVHv/JqWANj94QKkCXyyg+vuLCQW0+0GPQck+1qZUQA33v9MJmMhPAE2R3l+m+RnIBEzl1xsqARQzvbeM84dQCZjMbwgooB+gSgTUPL8NkYDp/ATQFOk9ZZl/iUbAhH6DMSioH5zKA9Q2PxiJgCn9uAQsCFDr/HUUAib14xKwHEDt8ysSCJjWj0vAYgCdmf8zf8DEflwCEgA0yRX1c/PTltr/dP3IAJrknqTZ+ZNL7X+6fkUBOj+/d6n9T9evJEAd5p8vtf/p+pEBFH8M6vJ8hFL7n64fHUAj0jvJ6fkdpfY/Xb9iAHV7vkyp/U/XrxRAHZ9/VGr/0/VDAJSi5PlHC5EC8Ej/85qV8/PjSl1B0fUrYhPv/nzDUvufrl8JgHo8f7PU/qfrVwCgPs+HLbX/6fotH1Cv5xeX2v90/RYPqN/ztUvtf7p+SwfU8/nvpfY/Xb8sgGpOuwfetDVXDk8+i+1/un45ANVcuBR62+tMOXz5LLb/6fotGlBvPovtf7p+SwbUn0+dXxFTwNP1W/AYNIDPtd8oS+ScG0z6n67fcvfiQ/js/MZI0gG0yyGALgXQID4pA7oOIoAuBNAwPjWAkhmDCqBLAjSQT80YNFICKIzh0gCl4idjUCDDhQEaugIttv/p+i0S0GA+i+1/un5LBDScz2L7n65fUkDTPAoxgs9i+5+uX0pA0zxMNobPYvufrt/iAI3is9j+p+u3NEDj+Cy2/+n6LQzQSD6L7X+6fssCNJbPYvufrt+i9uKj+Sy2/+n6MTgOasN6ZBjPZ7H9T9ePPqDWgcHQEIDPYvufrt9yAIXgs9j+p+u3GEBB+GTc/6HjewE0Or3TGBSGT76ABh8hEUATpAfjUwCNlgCqM4TiUwCN1hIABTwcujYE45MvoDIGhQG0LSPkCaWuMTg+GQNKxZA3oGorwPSAfBbb/3T9vAF9vVqtPjitr5+uHr6pJy9ZAIXks9j+p+vnDeiLo/bP2+dH9esPJy+OgMKOQUH5LLb/6fr5Anr72+P25fqr0/ry89PxyzygNfT1TDUsn8X2P10/X0CbjflqdVRffvGmvv7yePzSLH6vke3j3Sp0rg0PyQO6CpOae8PlZ8ftWvTiYYfk+KV/i+3XAHxJaMXk90/Xj0tAZ0A7vTgyrUHTAlpxKS9dPy4BfQENHYOCXrNckS7v+psSDohjmBvQdmt++7vT2+dP1rvvwxcXQAFVQRuC+vXbCroBkQxzA9oeB31wPD0A6nocFDJ9BW0I6yeAghq6AzqvNOkraENgP0hAB+MiAZQJoBW0Ibgf3Bh0uGcpgPIAdHN8nkl54ySAsgN0e/6ISXnjJIByA3R3fpNJeSMlY1BegA7OvzMpbwI/uWCZDKDD60OYlBffT275IAPo6PolJuXF9xNAqQA6vr4uf3lnuBBAYQzTAApwIn5y/Wf28s6BIWNQGMMkgAJcyjS9Pjl7eckASsWwbED3rp/PXl4BFNmPFaD793fkLy+RMSgZw5IB1dx/xKS8dP24BOQAqO7+OCblpevHJWASQOP24rX3bzIpL10/LgHTABqTXn9/MZPy0vXjEpA8oIb735mUl64fl4BpAA3fxJvmZ2BSXhQ/mPsPmVQwCaDhO0nG+UOYlBfDD+gObiYVpA2oeX4bjPKCTi0hgMIYkgbUMv8SQnlh55YAC9iHEkARAQ1cN9nmBysG0E0qGYMiAhrW9db569gD6tqWBlAYCaA7BXW9fX5F7mNQ55IIoEQBnZn/k0l5jXIvyd4YFEhMKpgE0IB109z8tEzKa5T3b1YAxQTUO/3s/MlMymuW729WAKUE6Pz83kzKC6SGZtoBEfwoA+ow/3xkOfbWX6T7H/b4Qi8BNDi9y/MR4sqx3+MCKDW/tID6FNjp+R0CaKwE0IF8Kuz2fJmiAJUxKCFAHZ9/VNQYFMOPS8CEgDoR6vp8LiblpevHJSAkoEat+XRpAv35XG4xROSkADyMvwXlugZ1f75h4O/VmAN4n4bNCoquX/Jz8TY++6Uez98kDOi6DSb9T9eP0sUi/XKf58MKoNQMlw+o1/OLQ8thCkIKUF1IATQ3oH7P16Zc3tgxqLZcAmhGQH/05pNLeYMkgA4MkwDqcKbTk08u5Q2SADowJAKoL59cyhsmGYPuDJMAOruJ9+aTS3np+nEJSAJQfz65lJeuH5eAFAAN4NNSjrAr00rtf7p+dAAN4dNcjsBrJ0vtf7p+ZHaSgvhMD2jum9wEUExALenD+EwOqLctk/6n60dkDRrIZ/IxqACa2o/GGDSUz+TlhQbU+2ckgOYANJjP9OWFHYP6D0QE0AyAVrvlYenhFOJnjS2AwhjmBLSyL3ZID6cAv3Hs6VcQQGEMMwJa2Re7pIdTLKB730HGoDCG+QCt7Iud0sMpIaByqsvHMBug1Xh5WHo4xY5B3QGVU11ehkkA1RAYvv8+TA+naD/nMagA6mWYBNDAPplPT9dPAAUyzARo7AqUS3l1kjGoj2EeQP34THGBean9T9cvJ6DefOLfooPb/wAjHAE0HaCe23f+gEKMwQXQZID6jj+TAgq2NyeAwhimB9R//yjhGBTueIMACmOYHNAKZiXFClAZg4Ybpga0AmKAJqCDDzPpf7p+eQCtPCZbdkg/I4+GAseg47cPvxqT/qfrlwXQymc2cIf0dvm0FFbeSQsCKLxhUkCrH8FGebrGpsaIgPbGAiieX3JANxOAwuyFaBrb4xEK0H2XjfO0BRmDghsmBDT8/LvbcdB9Hp35tL5Rw/n2v8wfZNL/dP1gAL1+unr4xg3QSg3+6ZVUtybc7XVb3+bWoH1VawPULCb9T9cPBNDb50f16w+dAK22Peo9CjUDOl5i4XN2/lw/QB1+Y0z6n64fCKDXX53Wl5+fOgC64xMPUJ/P+7whaNTMpP/p+oEAevnFm/r6y+Pmb+81Mr6t41Pt/jX4h5OM73ezmn+XbyBRcqmgT1083ADayvxjqKZHY4B+Xo5WDu8qdQVF1w94DWoFtCq2vHT9uASMA9RtDFqVW166flwCxgF6+/zJ/F58hZeerp8EBDKMA9TlOGiFmJ6unwQEMowEdCRtMxVmerp+EhDIEBvQCjU9XT8JCGSIDGg1agw8PV0/CQhkiAtoNW4MPD1dPwkIZIgKaDVpDDw9XT8JCGSICWg1bQw8PV0/CQhkiAhotdcYeHq6fhIQyBAP0Gq/MfD0dP0kIJAhGqCVpjHw9HT9JCCQIRagla4x8PR0/SQgkCESoNP7j0otL10/LgEhAd2pmv6H+WJmIpKAsUIOqHDtSy9vvEoPqHDtSy9vvEoPqHDtSy9vvEoPqHDtRaI4qdwBRCKbVO4AIpFNKncAkcgmlTuASGSTQvQe3VlHRd3d0n0y7UvmeJ+uVkeUA16sVh+krKAC9htoPMMYEV205e2TaV/yqp0N4/KzY7oB29+3KRlKQAXsN9B4dgcaevHg902iPpn2JW++i7Z/XxzRDdjKlAwloIK1G2o8Pw4VtRXsk2lfcuerjcnIBGzWkukCKli7ocYzjFFRC2ifTPuSO183awvlgJefPjhOGFDB2g1F5hc/EvU16PXTJzXpgIlX8QrWbigyY6aRLkmPQZv1U7MPTzlgq5SDZAVrN9R4hjEqaivYJ9O+ZE7X8Uk4YL8ZTxdQAfsNReK43VS0j4O+XrU6ohuwTdiMQRdxHFQkipfKHUAksknlDiAS2aRyBxCJbFK5A4hENqncAUQim1TuAAvTzbPu8WEHX2uWnd/57u2f7Rb89O3eYtxsLKVyB1iYbp7db1/OdLCNCRyyqlksWkvlDrAw9YBePXq8v0wADZDKHWBh2gH69mf/oO58127yW/CuHqmDf1xv4tv/ule/PVTqfj1ZnDs9QancARamHtCThsXDe+0/mz/O3n119eh+A2EHaPtf7Qp2zep4ce70BKVyB1iY+p2khrW3h4/7zXaDY/d61gG62bS3r9PFmcNTlModYGHq16B1P8Y863BV95u1ZPM/P2sB3Qw12+XTxflyk5XKHWBhmgLaklf3rxpAJ4tzJCYulTvAwjQB9Lw/INpReb6/iZ8szpGYuFTuAAvTBNCbZ826scHw6tG94U7SZkdpujhrdJpSuQMsTBNAu52mdjW5d5ip2dNX96aLMwanKpU7gEhkk8odQCSySeUOIBLZpHIHEIlsUrkDiEQ2qdwBRCKbVO4AIpFNKncAkcgmlTuASGSTyh1AJLLp/wE03MLybLU7YAAAAABJRU5ErkJggg==" /><!-- --></p>
<h2 id="pricing-the-abc-note">Pricing the ABC Note</h2>
<p>For each month, we model the daily change of Bitcoin volatility and prices by using the Heston Model. At the end of each month, we use the mean price of the previous month as strike price (K), and the final price of the month as stock price (S) to calculate the corresponding straddle payoff in that month. We simulate the price path and payoff for 24 months and sum all the monthly straddle payoff together to get the total payoff the ABC note. We repeat this process for 10000 trials and take the mean of all trials to get the expected ABC Note payoff, which is also the approximated option price.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for pricing the ABC Note</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>pricing <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">btc=</span>bt.btc,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ret =</span> BTC.r,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pricefn =</span> <span class="st">&quot;straddle&quot;</span>, <span class="co"># monthly payoff structure: straddle or strangle</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> <span class="dv">10000</span>, <span class="co"># trials</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">T =</span> <span class="dv">2</span>, <span class="co"># 2 years</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">m =</span> T<span class="sc">*</span><span class="dv">365</span>,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">dt =</span> T<span class="sc">/</span>m, <span class="co"># time step</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial.S =</span> btc<span class="sc">$</span>S[<span class="fu">length</span>(btc<span class="sc">$</span>S)], <span class="co"># most recent bitcoin price</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial.K =</span> btc<span class="sc">$</span>K[<span class="fu">length</span>(btc<span class="sc">$</span>K)], <span class="co"># most recent month mean price</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">s1 =</span> <span class="dv">1</span>, <span class="co"># for strangle variant</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">s2 =</span> <span class="dv">1</span>, <span class="co"># for strangle variant</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">cnum =</span> <span class="dv">1</span>, <span class="co"># number of call</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">pnum =</span> <span class="dv">1</span>, <span class="co"># number of put</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">kappa =</span> k.m1, <span class="co"># approximated through method 1</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> x.m1, <span class="co"># approximated through method 1</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> btc<span class="sc">$</span>r[<span class="fu">length</span>(btc<span class="sc">$</span>r)], <span class="co"># risk-free rate (3m t-bills)</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> (<span class="fu">sd</span>(ret<span class="sc">$</span>.)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">365</span>)))<span class="sc">^</span><span class="dv">2</span> <span class="co"># annualized volatility of return</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>){</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Payoff Functions </span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  call <span class="ot">&lt;-</span> <span class="cf">function</span>(S,K) <span class="fu">max</span>(S<span class="sc">-</span>K,<span class="dv">0</span>) <span class="co"># European</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  put <span class="ot">&lt;-</span> <span class="cf">function</span>(S,K) <span class="fu">max</span>(K<span class="sc">-</span>S,<span class="dv">0</span>) <span class="co"># European</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Long cnum call and pnum put at the same strike</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  straddle <span class="ot">&lt;-</span> <span class="cf">function</span>(S, K, <span class="at">cnum =</span> <span class="dv">1</span>, <span class="at">pnum =</span> <span class="dv">1</span>) {</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">call</span>(S,K)<span class="sc">*</span>cnum <span class="sc">+</span> <span class="fu">put</span>(S,K)<span class="sc">*</span>pnum} </span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Long pnum put with strike K1 and cnum call with strike K2, whre K2 &gt; K1</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>  strangle <span class="ot">&lt;-</span> <span class="cf">function</span>(S, K1, K2, <span class="at">cnum =</span> <span class="dv">1</span>, <span class="at">pnum =</span> <span class="dv">1</span>){</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">call</span>(S,K2)<span class="sc">*</span>cnum <span class="sc">+</span> <span class="fu">put</span>(S,K1)<span class="sc">*</span>pnum} </span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initializing price, volatility, payoff path, and first strike price</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> nu <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>  s[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial.S</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">&lt;-</span> initial.K </span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>  nu[<span class="dv">1</span>] <span class="ot">&lt;-</span> theta <span class="co"># most recent 30d vol</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The Monte Carlo Simulation of product price</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">foreach</span> (<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>d)<span class="sc">%dorng%</span>{</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>      monthly.payoff <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">24</span>)</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>){ <span class="co"># 24 months</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(h <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">31</span>){ <span class="co"># assuming 30 days in one month</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>            c <span class="ot">&lt;-</span> h<span class="sc">+</span><span class="dv">30</span><span class="sc">*</span>(j<span class="dv">-1</span>)</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>          <span class="co"># stochastic terms</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>          dW1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(dt)<span class="sc">*</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>          dW2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(dt)<span class="sc">*</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>          <span class="co"># modelling the change of bitcoin price and volatility</span></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>          ds <span class="ot">&lt;-</span> r<span class="sc">*</span>s[c<span class="dv">-1</span>]<span class="sc">*</span>dt<span class="sc">+</span><span class="fu">sqrt</span>(nu[c<span class="dv">-1</span>])<span class="sc">*</span>s[c<span class="dv">-1</span>]<span class="sc">*</span>dW1</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>          dnu <span class="ot">&lt;-</span> kappa <span class="sc">*</span>(theta<span class="sc">-</span>nu[c<span class="dv">-1</span>])<span class="sc">*</span>dt <span class="sc">+</span> x<span class="sc">*</span><span class="fu">sqrt</span>(nu[c<span class="dv">-1</span>])<span class="sc">*</span>dW2</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>          s[c] <span class="ot">&lt;-</span> s[c<span class="dv">-1</span>]<span class="sc">+</span>ds</span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>          nu[c] <span class="ot">&lt;-</span> <span class="fu">max</span>(nu[c<span class="dv">-1</span>]<span class="sc">+</span>dnu,<span class="dv">0</span>) <span class="co"># Ensure non-negative &quot;nu&quot;</span></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for each month. calculate the new K by the mean of last month price</span></span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>        K <span class="ot">&lt;-</span> <span class="fu">mean</span>(s[(<span class="dv">1</span><span class="sc">+</span><span class="dv">30</span><span class="sc">*</span>(j<span class="dv">-1</span>))<span class="sc">:</span>(<span class="dv">30</span><span class="sc">+</span><span class="dv">30</span><span class="sc">*</span>(j<span class="dv">-1</span>))])</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculating the payoff of strangle and other product variants</span></span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (pricefn <span class="sc">==</span> <span class="st">&quot;straddle&quot;</span>){ <span class="co"># Default</span></span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a>          monthly.payoff[j] <span class="ot">&lt;-</span> <span class="fu">straddle</span>(s[<span class="dv">30</span><span class="sc">+</span><span class="dv">30</span><span class="sc">*</span>(j<span class="dv">-1</span>)],</span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>                                        K,</span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>                                        cnum,</span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>                                        pnum)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>j<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>                                        <span class="co"># Product Variant 1</span></span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>                                        }<span class="cf">else</span> <span class="cf">if</span>(pricefn <span class="sc">==</span> <span class="st">&quot;strangle&quot;</span>){</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a>          monthly.payoff[j] <span class="ot">&lt;-</span> <span class="fu">strangle</span>(s[<span class="dv">30</span><span class="sc">+</span><span class="dv">30</span><span class="sc">*</span>(j<span class="dv">-1</span>)],</span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a>                                        K<span class="sc">*</span>s1,</span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a>                                        K<span class="sc">*</span>s2,</span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a>                                        cnum,</span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a>                                        pnum)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>j<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>                                        <span class="co"># Product Variant 3</span></span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a>                                        } <span class="cf">else</span> <span class="cf">if</span>(pricefn <span class="sc">==</span> <span class="st">&quot;Asian&quot;</span>){</span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>          monthly.payoff[j] <span class="ot">&lt;-</span><span class="fu">straddle</span>(<span class="fu">mean</span>((s[<span class="dv">1</span><span class="sc">+</span><span class="dv">30</span><span class="sc">*</span>(j<span class="dv">-1</span>)]))<span class="sc">:</span>(s[<span class="dv">30</span><span class="sc">+</span><span class="dv">30</span><span class="sc">*</span>(j<span class="dv">-1</span>)]),</span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>                                       K,</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a>                                       cnum,</span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>                                       pnum)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>j<span class="sc">/</span><span class="dv">12</span>)                         </span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>                                        }</span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(monthly.payoff)</span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a>  }  </span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(f <span class="sc">%&gt;%</span> unlist)</span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pricing ABC Note</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>f.vec <span class="ot">&lt;-</span> <span class="fu">pricing</span>()</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>ABC.price <span class="ot">&lt;-</span> <span class="fu">mean</span>(f.vec)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Straddle Price:&quot;</span>,<span class="fu">round</span>(ABC.price,<span class="dv">4</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Straddle Price: 275747.1</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Standard Error:&quot;</span>,<span class="fu">round</span>(<span class="fu">sd</span>(f.vec)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10000</span>),<span class="dv">4</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Standard Error: 92156.08</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw straddle price is too high for retail investors, hence we restructure</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the product and run the backtest</span></span></code></pre></div>
<h2 id="restructuring-the-abc-note">Restructuring the ABC Note</h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here with demonstrate for each 1000USD, where will it be invested</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>ca <span class="ot">&lt;-</span>  <span class="cf">function</span>(<span class="at">target =</span> <span class="dv">1000</span>, <span class="co"># target price</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">m.fee =</span> <span class="fl">0.01</span>, <span class="co"># management fee</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">g.rate =</span> <span class="fl">0.8</span>, <span class="co"># capital guarantee rate</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rf =</span> bt.btc<span class="sc">$</span>r[<span class="fu">length</span>(bt.btc<span class="sc">$</span>r)], <span class="co"># risk free rate</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">rf.bond =</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>rf<span class="sc">*</span><span class="dv">2</span>),</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                price,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">printp =</span> <span class="cn">FALSE</span>){ <span class="co"># risk free bond</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Participation rate: unit of straddle purchased</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>p.rate <span class="ot">&lt;-</span> (target<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>m.fee)<span class="sc">-</span>g.rate<span class="sc">*</span>target<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>rf))<span class="sc">/</span>price</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># unit of bonds purchased</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>b.rate <span class="ot">&lt;-</span> (target <span class="sc">-</span> p.rate<span class="sc">*</span>price)<span class="sc">/</span>rf.bond</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (printp <span class="sc">==</span> <span class="cn">TRUE</span>){</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Participation rate:&quot;</span>, p.rate,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;unit in bond purchased:&quot;</span>, b.rate,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;unit in straddles:&quot;</span>, p.rate,<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">c</span>(p.rate,b.rate))</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h1 id="backtesting">Backtesting</h1>
<p>In this section, we explore the return of ABC Note if it existed in 2017-2019. We find that the ABC Note (capital allocated) can return an <strong>annualized return of ~50%</strong> in the investment period 2019-2021</p>
<h2 id="backtesting-return-of-abc-note">Backtesting return of ABC Note</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>bt.ret <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">4</span>, <span class="co"># number of years before</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">s1 =</span> <span class="dv">1</span>, <span class="co"># for strangle variation</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s2 =</span> <span class="dv">1</span>, <span class="co"># for strangle variation</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cnum =</span> <span class="dv">1</span>, <span class="co"># number of call</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">pnum =</span> <span class="dv">1</span>, <span class="co"># number of put</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">target =</span> <span class="dv">1000</span>, <span class="co"># target price of product</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pricefn =</span> <span class="st">&quot;straddle&quot;</span>){ <span class="co"># pricing function</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>year){ </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    start.d <span class="ot">&lt;-</span> date<span class="dv">-365</span><span class="sc">*</span>i <span class="co"># model start date</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    end.d <span class="ot">&lt;-</span> date <span class="sc">-</span> <span class="dv">365</span><span class="sc">*</span>(i<span class="dv">-2</span>)  <span class="co"># model end date</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For pricing: simulate the data known at the start date</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    bt.btc.i1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(bt.btc,Date <span class="sc">&lt;=</span> start.d) </span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    ret.i1 <span class="ot">&lt;-</span> bt.btc.i1<span class="sc">$</span>S <span class="sc">%&gt;%</span> log <span class="sc">%&gt;%</span> diff <span class="sc">%&gt;%</span> na.omit <span class="co"># calculate return</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For payoff: only get the last price in each month</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    btc.K.i <span class="ot">&lt;-</span> <span class="fu">subset</span>(btc.K, Date <span class="sc">&lt;=</span> end.d <span class="sc">&amp;</span> Date<span class="sc">&gt;=</span> start.d)</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    bt.p <span class="ot">&lt;-</span> btc.K.i <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(short_d) <span class="sc">%&gt;%</span> <span class="fu">summarise_all</span>(last) </span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> bt.btc.i1<span class="sc">$</span>r[<span class="fu">length</span>(bt.btc.i1<span class="sc">$</span>r)] <span class="co"># intial risk free</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Price the ABC Note at start date</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    price <span class="ot">&lt;-</span> <span class="fu">pricing</span>(</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">d =</span> <span class="dv">10000</span>,</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">pricefn =</span> pricefn, <span class="co"># type of monthly payoff: straddle/strangle</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">initial.S =</span> bt.btc.i1<span class="sc">$</span>S[<span class="fu">length</span>(bt.btc.i1<span class="sc">$</span>S)], <span class="co"># initial Bitcoin price</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">initial.K =</span> bt.btc.i1<span class="sc">$</span>K[<span class="fu">length</span>(bt.btc.i1<span class="sc">$</span>K)], <span class="co"># initial strike</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">r =</span> r, <span class="co"># intial risk free</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">cnum =</span> cnum, <span class="co"># number of call</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">pnum =</span> pnum, <span class="co"># number of put</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> (<span class="fu">sd</span>(ret.i1)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">365</span>))<span class="sc">^</span><span class="dv">2</span> <span class="co"># long run volatility</span></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> mean</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(pricefn <span class="sc">==</span> <span class="st">&quot;straddle&quot;</span><span class="sc">|</span>pricefn<span class="sc">==</span><span class="st">&quot;strangle&quot;</span>){</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>      bt.p<span class="sc">$</span>putpayoff <span class="ot">&lt;-</span> <span class="fu">pmax</span>(bt.p<span class="sc">$</span>K<span class="sc">*</span>s1<span class="sc">-</span>bt.p<span class="sc">$</span>S,<span class="dv">0</span>) <span class="co"># monthly put payoff</span></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>      bt.p<span class="sc">$</span>callpayoff <span class="ot">&lt;-</span> <span class="fu">pmax</span>(bt.p<span class="sc">$</span>S<span class="sc">-</span>bt.p<span class="sc">$</span>K<span class="sc">*</span>s2,<span class="dv">0</span>) <span class="co"># monthly call payoff </span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Total payoff = sum of call and put payoff, </span></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>      <span class="co"># missing months in the data are approximated as the mean of other months</span></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>      payoff <span class="ot">&lt;-</span> (<span class="fu">sum</span>(bt.p<span class="sc">$</span>putpayoff)<span class="sc">+</span></span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>(bt.p<span class="sc">$</span>callpayoff))<span class="sc">*</span>(<span class="dv">24</span><span class="sc">/</span><span class="fu">length</span>(bt.p<span class="sc">$</span>Date)) </span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>      ret <span class="ot">&lt;-</span> (payoff)<span class="sc">/</span>price <span class="sc">-</span><span class="dv">1</span> <span class="co"># Calculating Investors&#39; return</span></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span> <span class="cf">if</span>(pricefn <span class="sc">==</span> <span class="st">&quot;Asian&quot;</span>){</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>        group2 <span class="ot">&lt;-</span> btc.K.i <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(short_d) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">S.asian =</span> <span class="fu">mean</span>(S))</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>        bt.p2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(btc.K.i,group2) </span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>        bt.p2 <span class="ot">&lt;-</span> bt.p2 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(short_d) <span class="sc">%&gt;%</span> <span class="fu">summarise_all</span>(last)</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>        bt.p2<span class="sc">$</span>putpayoff <span class="ot">&lt;-</span> <span class="fu">pmax</span>(bt.p2<span class="sc">$</span>K<span class="sc">-</span>bt.p2<span class="sc">$</span>S.asian,<span class="dv">0</span>) <span class="co"># monthly put payoff</span></span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>        bt.p2<span class="sc">$</span>callpayoff <span class="ot">&lt;-</span> <span class="fu">pmax</span>(bt.p2<span class="sc">$</span>S.asian<span class="sc">-</span>bt.p2<span class="sc">$</span>K,<span class="dv">0</span>) <span class="co"># monthly call payoff </span></span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>        payoff <span class="ot">&lt;-</span> (<span class="fu">sum</span>(bt.p2<span class="sc">$</span>putpayoff)<span class="sc">+</span></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">sum</span>(bt.p2<span class="sc">$</span>callpayoff))<span class="sc">*</span>(<span class="dv">24</span><span class="sc">/</span><span class="fu">length</span>(bt.p<span class="sc">$</span>Date)) </span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>        ret <span class="ot">&lt;-</span> (payoff)<span class="sc">/</span>price <span class="sc">-</span><span class="dv">1</span> <span class="co"># Calculating Investors&#39; return</span></span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Investment Period:&quot;</span>,</span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.Date</span>(start.d,<span class="st">&quot;%m/%d/%Y&quot;</span>),<span class="st">&quot;-&quot;</span>,<span class="fu">as.Date</span>(end.d,<span class="st">&quot;%m/%d/%Y&quot;</span>)))</span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;straddle price:&quot;</span>,price,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;straddle payoff:&quot;</span>,payoff,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a>    a.ret <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">+</span>ret)<span class="sc">^</span><span class="fl">0.5</span><span class="dv">-1</span> <span class="co"># annualized raw return</span></span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Backtest annualized return of raw straddle: &quot;</span>,<span class="st">&quot;: &quot;</span>,</span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a>        a.ret<span class="sc">*</span><span class="dv">100</span>,<span class="st">&quot;%&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>    rates <span class="ot">&lt;-</span> <span class="fu">ca</span>(<span class="at">rf =</span> bt.btc.i1<span class="sc">$</span>r[<span class="fu">length</span>(bt.btc.i1<span class="sc">$</span>r)],</span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a>                <span class="at">price=</span>price,</span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a>                <span class="at">printp =</span><span class="cn">TRUE</span>,</span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a>                <span class="at">target=</span>target)</span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># annualized capital allocated return</span></span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a>    a.ca.ret <span class="ot">&lt;-</span> ((payoff<span class="sc">*</span>rates[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">100</span><span class="sc">*</span>rates[<span class="dv">2</span>])<span class="sc">/</span>target)<span class="sc">^</span><span class="fl">0.5</span><span class="dv">-1</span></span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Backtest annualized return of capital allocated ABC Note: &quot;</span>,<span class="st">&quot;: &quot;</span>,</span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a>        a.ca.ret<span class="sc">*</span><span class="dv">100</span>,<span class="st">&quot;%&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Backtesting past returns</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bt.ret</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Investment Period: 2019-11-18 - 2021-11-17&quot;
## straddle price: 18437.06 
## straddle payoff: 140210.8 
## Backtest annualized return of raw straddle: : 175.7687%
## 
## Participation rate: 0.01123082 
## unit in bond purchased: 8.102179 
## unit in straddles: 0.01123082 
## 
## Backtest annualized return of capital allocated ABC Note: : 54.43125%
## 
## 
## [1] &quot;Investment Period: 2018-11-18 - 2020-11-17&quot;
## straddle price: 14008.25 
## straddle payoff: 41470.88 
## Backtest annualized return of raw straddle: : 72.0599%
## 
## Participation rate: 0.0153808 
## unit in bond purchased: 8.103287 
## unit in straddles: 0.0153808 
## 
## Backtest annualized return of capital allocated ABC Note: : 20.34052%
## 
## 
## [1] &quot;Investment Period: 2017-11-18 - 2019-11-18&quot;
## straddle price: 337206.9 
## straddle payoff: 41966.14 
## Backtest annualized return of raw straddle: : -64.72222%
## 
## Participation rate: 0.000604935 
## unit in bond purchased: 8.10178 
## unit in straddles: 0.000604935 
## 
## Backtest annualized return of capital allocated ABC Note: : -8.590769%</code></pre>
<h1 id="product-variants">Product Variants</h1>
<p>Here we explore alternatives of the ABC Note:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Changing all the monthly straddles into strangles:</strong> With this change, the price of the product does decrease, however, the payoff of the ABC Note decreases even for a larger extent, hence resulting in a smaller return.</p></li>
<li><p><strong>Changing ratio of call and put in the straddle:</strong> With this change, price decreases while payoff remains in similar levels in all backtesting years. Hence, it may be profitable to change the ratio of call and put.</p></li>
<li><p><strong>Using mean price as stock price:</strong> This change increases price and decreases payoff, hence not recommended.</p></li>
</ol>
<h2 id="strangle-version-of-abc-note">Strangle version of ABC Note</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for backtesting return of strangle ver. ABC Note</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>ret.strng <span class="ot">&lt;-</span> <span class="cf">function</span>(para,data){</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    call <span class="ot">&lt;-</span> <span class="cf">function</span>(S,K) <span class="fu">max</span>(S<span class="sc">-</span>K,<span class="dv">0</span>) <span class="co"># European</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    put <span class="ot">&lt;-</span> <span class="cf">function</span>(S,K) <span class="fu">max</span>(K<span class="sc">-</span>S,<span class="dv">0</span>) <span class="co"># European</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>strangle.payoff <span class="ot">&lt;-</span> <span class="fu">call</span>(data<span class="sc">$</span>S,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                                 data<span class="sc">$</span>K<span class="sc">*</span>(para[<span class="dv">2</span>]<span class="sc">+</span>para[<span class="dv">1</span>]))<span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">put</span>(data<span class="sc">$</span>S,data<span class="sc">$</span>K<span class="sc">*</span>(para[<span class="dv">1</span>]))</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data,Date<span class="sc">&gt;</span>date<span class="dv">-365</span><span class="sc">*</span><span class="dv">2</span>) <span class="co"># only get data after 2019</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>ret <span class="ot">&lt;-</span> data<span class="sc">$</span>S <span class="sc">%&gt;%</span> log <span class="sc">%&gt;%</span> diff <span class="sc">%&gt;%</span> na.omit</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">pricing</span>(</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ret =</span> ret,</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> <span class="dv">1000</span>,</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">pricefn =</span> <span class="st">&quot;strangle&quot;</span>, <span class="co"># monthly payoff structure: straddle or strangle</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">T =</span> <span class="dv">2</span>, <span class="co"># 2 years</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">m =</span> T<span class="sc">*</span><span class="dv">365</span>,</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">dt =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">365</span>, <span class="co"># time step</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial.S =</span> data<span class="sc">$</span>S[<span class="dv">1</span>], <span class="co"># most recent bitcoin price</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial.K =</span> data<span class="sc">$</span>K[<span class="dv">1</span>], <span class="co"># most recent month mean price</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">s1 =</span> para[<span class="dv">1</span>], <span class="co"># for strangle variant</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">s2 =</span> para[<span class="dv">1</span>]<span class="sc">+</span>para[<span class="dv">2</span>], <span class="co"># for strangle variant</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> data<span class="sc">$</span>r[<span class="dv">1</span>], <span class="co"># risk-free rate (3m t-bills)</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> (<span class="fu">sd</span>(ret)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">365</span>)))<span class="sc">^</span><span class="dv">2</span> <span class="co"># annualized volatility of return</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(data<span class="sc">$</span>strangle.payoff)<span class="sc">/</span><span class="fu">mean</span>(price)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the strike scalars that return the highest return</span></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>opm <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="co"># Initial Guess</span></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>             ret.strng, <span class="co"># function for payoff for strangle ver. ABC Note</span></span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>bt.btc, </span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">control=</span><span class="fu">list</span>(<span class="at">fnscale=</span><span class="sc">-</span><span class="dv">1</span>), <span class="co"># maximize the function</span></span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">lower =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="co"># lower bound</span></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">upper =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="co"># upper bound</span></span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">&quot;L-BFGS-B&quot;</span>) <span class="co"># for box constraint maximization</span></span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> opm<span class="sc">$</span>par[<span class="dv">1</span>]</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> opm<span class="sc">$</span>par[<span class="dv">1</span>]<span class="sc">+</span>opm<span class="sc">$</span>par[<span class="dv">2</span>]</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Optimal Scalar for put strike price:&quot;</span>,s1,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Optimal Scalar for put strike price: 1</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Optimal Scalar for call strike price:&quot;</span>,s2,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Optimal Scalar for call strike price: 1.5</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Backtest variant result</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bt.ret</span>(<span class="at">year =</span> <span class="dv">4</span>, <span class="co"># backtest year</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">s1 =</span> s1, <span class="co"># put scalar obtained before</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">s2 =</span> s2, <span class="co"># call scalar obtained before</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">pricefn =</span> <span class="st">&quot;strangle&quot;</span>) <span class="co"># pricing function</span></span></code></pre></div>
<pre><code>## [1] &quot;Investment Period: 2019-11-18 - 2021-11-17&quot;
## straddle price: 21675.65 
## straddle payoff: 43555.16 
## Backtest annualized return of raw straddle: : 41.75349%
## 
## Participation rate: 0.009552811 
## unit in bond purchased: 8.102179 
## unit in straddles: 0.009552811 
## 
## Backtest annualized return of capital allocated ABC Note: : 10.73808%
## 
## 
## [1] &quot;Investment Period: 2018-11-18 - 2020-11-17&quot;
## straddle price: 18339.96 
## straddle payoff: 14789.61 
## Backtest annualized return of raw straddle: : -10.19943%
## 
## Participation rate: 0.01174801 
## unit in bond purchased: 8.103287 
## unit in straddles: 0.01174801 
## 
## Backtest annualized return of capital allocated ABC Note: : -0.7993347%
## 
## 
## [1] &quot;Investment Period: 2017-11-18 - 2019-11-18&quot;
## straddle price: 34826.2 
## straddle payoff: 26163.26 
## Backtest annualized return of raw straddle: : -13.3252%
## 
## Participation rate: 0.005857322 
## unit in bond purchased: 8.10178 
## unit in straddles: 0.005857322 
## 
## Backtest annualized return of capital allocated ABC Note: : -1.845806%</code></pre>
<h2 id="different-ratio-of-call-and-put-in-the-straddle">Different ratio of call and put in the straddle</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for calculating strangle ver. ABC Note</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>ret.strng <span class="ot">&lt;-</span> <span class="cf">function</span>(para,data){</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    call <span class="ot">&lt;-</span> <span class="cf">function</span>(S,K) <span class="fu">max</span>(S<span class="sc">-</span>K,<span class="dv">0</span>) <span class="co"># European</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    put <span class="ot">&lt;-</span> <span class="cf">function</span>(S,K) <span class="fu">max</span>(K<span class="sc">-</span>S,<span class="dv">0</span>) <span class="co"># European</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>strangle.payoff <span class="ot">&lt;-</span> <span class="fu">call</span>(data<span class="sc">$</span>S,data<span class="sc">$</span>K)<span class="sc">*</span>para<span class="sc">+</span><span class="fu">put</span>(data<span class="sc">$</span>S,data<span class="sc">$</span>K)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>para)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data,Date<span class="sc">&gt;</span>date<span class="dv">-365</span><span class="sc">*</span><span class="dv">2</span>) <span class="co"># only get data after 2019</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>ret <span class="ot">&lt;-</span> data<span class="sc">$</span>S <span class="sc">%&gt;%</span> log <span class="sc">%&gt;%</span> diff <span class="sc">%&gt;%</span> na.omit</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">pricing</span>(</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> <span class="dv">1000</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pricefn =</span> <span class="st">&quot;straddle&quot;</span>, <span class="co"># monthly payoff structure: straddle or strangle</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">T =</span> <span class="dv">2</span>, <span class="co"># 2 years</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">m =</span> T<span class="sc">*</span><span class="dv">365</span>,</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">dt =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">365</span>, <span class="co"># time step</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial.S =</span> data<span class="sc">$</span>S[<span class="dv">1</span>], <span class="co"># most recent bitcoin price</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial.K =</span> data<span class="sc">$</span>K[<span class="dv">1</span>], <span class="co"># most recent month mean price</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">cnum =</span> para,</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">pnum =</span> <span class="dv">1</span> <span class="sc">-</span> para,</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> data<span class="sc">$</span>r[<span class="dv">1</span>], <span class="co"># risk-free rate (3m t-bills)</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> (<span class="fu">sd</span>(ret)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">365</span>)))<span class="sc">^</span><span class="dv">2</span> <span class="co"># annualized volatility of return</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(data<span class="sc">$</span>strangle.payoff)<span class="sc">/</span><span class="fu">mean</span>(price))</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the strike scalars that return the highest return</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>opm <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fl">0.5</span>, <span class="co"># Initial Guess</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>             ret.strng, <span class="co"># function for payoff for strangle ver. ABC Note</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>bt.btc, </span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">control=</span><span class="fu">list</span>(<span class="at">fnscale=</span><span class="sc">-</span><span class="dv">1</span>), <span class="co"># maximize the function</span></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">lower =</span> <span class="dv">0</span>, <span class="co"># lower bound</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">upper =</span> <span class="dv">1</span>, <span class="co"># upper bound</span></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">&quot;Brent&quot;</span>) <span class="co"># one-dimensional constrained optimization</span></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>cnum <span class="ot">&lt;-</span> opm<span class="sc">$</span>par[<span class="dv">1</span>] <span class="co"># ratio of call</span></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>pnum <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> opm<span class="sc">$</span>par[<span class="dv">1</span>] <span class="co"># ratio of put</span></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Optimal ratio of call:&quot;</span>,cnum,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Optimal ratio of call: 0.7647753</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Optimal ratio of put:&quot;</span>,pnum,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Optimal ratio of put: 0.2352247</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Backtest variant result</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bt.ret</span>(<span class="at">year =</span> <span class="dv">4</span>, <span class="co"># backtest year</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">cnum =</span> cnum, <span class="co"># put scalar obtained before</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">pnum =</span> pnum, <span class="co"># call scalar obtained before</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">pricefn =</span> <span class="st">&quot;straddle&quot;</span>) <span class="co"># pricing function</span></span></code></pre></div>
<pre><code>## [1] &quot;Investment Period: 2019-11-18 - 2021-11-17&quot;
## straddle price: 11636.86 
## straddle payoff: 140210.8 
## Backtest annualized return of raw straddle: : 247.1146%
## 
## Participation rate: 0.01779375 
## unit in bond purchased: 8.102179 
## unit in straddles: 0.01779375 
## 
## Backtest annualized return of capital allocated ABC Note: : 81.79919%
## 
## 
## [1] &quot;Investment Period: 2018-11-18 - 2020-11-17&quot;
## straddle price: 6896.314 
## straddle payoff: 41470.88 
## Backtest annualized return of raw straddle: : 145.2241%
## 
## Participation rate: 0.03124251 
## unit in bond purchased: 8.103287 
## unit in straddles: 0.03124251 
## 
## Backtest annualized return of capital allocated ABC Note: : 45.12005%
## 
## 
## [1] &quot;Investment Period: 2017-11-18 - 2019-11-18&quot;
## straddle price: 8201.249 
## straddle payoff: 41966.14 
## Backtest annualized return of raw straddle: : 126.2088%
## 
## Participation rate: 0.02487283 
## unit in bond purchased: 8.10178 
## unit in straddles: 0.02487283 
## 
## Backtest annualized return of capital allocated ABC Note: : 36.16147%</code></pre>
<h2 id="mean-stock-price">Mean stock price</h2>
<p>Instead of calculating the monthly straddle payoff by using last price in month n as stock price, we calculate straddle payoff by using the mean price of month n as stock price.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Backtest variant result</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bt.ret</span>(<span class="at">year =</span> <span class="dv">4</span>, <span class="co"># backtest year</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">pricefn =</span> <span class="st">&quot;Asian&quot;</span>) <span class="co"># pricing function</span></span></code></pre></div>
<pre><code>## [1] &quot;Investment Period: 2019-11-18 - 2021-11-17&quot;
## straddle price: 56085.9 
## straddle payoff: 106587.8 
## Backtest annualized return of raw straddle: : 37.85641%
## 
## Participation rate: 0.003691897 
## unit in bond purchased: 8.102179 
## unit in straddles: 0.003691897 
## 
## Backtest annualized return of capital allocated ABC Note: : 9.714599%
## 
## 
## [1] &quot;Investment Period: 2018-11-18 - 2020-11-17&quot;
## straddle price: 27305.25 
## straddle payoff: 28655.03 
## Backtest annualized return of raw straddle: : 2.441834%
## 
## Participation rate: 0.007890722 
## unit in bond purchased: 8.103287 
## unit in straddles: 0.007890722 
## 
## Backtest annualized return of capital allocated ABC Note: : 1.805576%
## 
## 
## [1] &quot;Investment Period: 2017-11-18 - 2019-11-18&quot;
## straddle price: 37492.54 
## straddle payoff: 32481.07 
## Backtest annualized return of raw straddle: : -6.922928%
## 
## Participation rate: 0.005440769 
## unit in bond purchased: 8.10178 
## unit in straddles: 0.005440769 
## 
## Backtest annualized return of capital allocated ABC Note: : -0.6571615%</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This variant, albeit not recommended, kinda exhibits scalability of</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this program as I just add a new &quot;else if&quot; in both the functions &quot;pricing&quot; </span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and &quot;bt.ret&quot; and this variant become a one-liner.</span></span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check how much time has been spent for running the program</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;This program needs:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## This program needs:</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> start.time </span></code></pre></div>
<pre><code>## Time difference of 23.96163 mins</code></pre>

</body>
</html>
